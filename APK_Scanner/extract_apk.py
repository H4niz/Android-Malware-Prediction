from pyaxmlparser import APK
import csv
import os, sys
import shutil
import re

#-*- coding: utf-8 -*-

full_features = {'ACCESS_ALL_DOWNLOADS': 0, 'ACCESS_BLUETOOTH_SHARE': 1, 'ACCESS_CACHE_FILESYSTEM': 2, 'ACCESS_CHECKIN_PROPERTIES': 3, 'ACCESS_CONTENT_PROVIDERS_EXTERNALLY': 4, 'ACCESS_DOWNLOAD_MANAGER': 5, 'ACCESS_DOWNLOAD_MANAGER_ADVANCED': 6, 'ACCESS_DRM_CERTIFICATES': 7, 'ACCESS_EPHEMERAL_APPS': 8, 'ACCESS_FM_RADIO': 9, 'ACCESS_INPUT_FLINGER': 10, 'ACCESS_KEYGUARD_SECURE_STORAGE': 11, 'ACCESS_LOCATION_EXTRA_COMMANDS': 12, 'ACCESS_MOCK_LOCATION': 13, 'ACCESS_MTP': 14, 'ACCESS_NETWORK_CONDITIONS': 15, 'ACCESS_NETWORK_STATE': 16, 'ACCESS_NOTIFICATIONS': 17, 'ACCESS_NOTIFICATION_POLICY': 18, 'ACCESS_PDB_STATE': 19, 'ACCESS_SURFACE_FLINGER': 20, 'ACCESS_VOICE_INTERACTION_SERVICE': 21, 'ACCESS_VR_MANAGER': 22, 'ACCESS_WIFI_STATE': 23, 'ACCESS_WIMAX_STATE': 24, 'ACCOUNT_MANAGER': 25, 'ALLOW_ANY_CODEC_FOR_PLAYBACK': 26, 'ASEC_ACCESS': 27, 'ASEC_CREATE': 28, 'ASEC_DESTROY': 29, 'ASEC_MOUNT_UNMOUNT': 30, 'ASEC_RENAME': 31, 'AUTHENTICATE_ACCOUNTS': 32, 'BACKUP': 33, 'BATTERY_STATS': 34, 'BIND_ACCESSIBILITY_SERVICE': 35, 'BIND_APPWIDGET': 36, 'BIND_CARRIER_MESSAGING_SERVICE': 37, 'BIND_CARRIER_SERVICES': 38, 'BIND_CHOOSER_TARGET_SERVICE': 39, 'BIND_CONDITION_PROVIDER_SERVICE': 40, 'BIND_CONNECTION_SERVICE': 41, 'BIND_DEVICE_ADMIN': 42, 'BIND_DIRECTORY_SEARCH': 43, 'BIND_DREAM_SERVICE': 44, 'BIND_INCALL_SERVICE': 45, 'BIND_INPUT_METHOD': 46, 'BIND_INTENT_FILTER_VERIFIER': 47, 'BIND_JOB_SERVICE': 48, 'BIND_KEYGUARD_APPWIDGET': 49, 'BIND_MIDI_DEVICE_SERVICE': 50, 'BIND_NFC_SERVICE': 51, 'BIND_NOTIFICATION_LISTENER_SERVICE': 52, 'BIND_NOTIFICATION_RANKER_SERVICE': 53, 'BIND_PACKAGE_VERIFIER': 54, 'BIND_PRINT_RECOMMENDATION_SERVICE': 55, 'BIND_PRINT_SERVICE': 56, 'BIND_PRINT_SPOOLER_SERVICE': 57, 'BIND_QUICK_SETTINGS_TILE': 58, 'BIND_REMOTEVIEWS': 59, 'BIND_REMOTE_DISPLAY': 60, 'BIND_ROUTE_PROVIDER': 61, 'BIND_RUNTIME_PERMISSION_PRESENTER_SERVICE': 62, 'BIND_SCREENING_SERVICE': 63, 'BIND_TELECOM_CONNECTION_SERVICE': 64, 'BIND_TEXT_SERVICE': 65, 'BIND_TRUST_AGENT': 66, 'BIND_TV_INPUT': 67, 'BIND_TV_REMOTE_SERVICE': 68, 'BIND_VOICE_INTERACTION': 69, 'BIND_VPN_SERVICE': 70, 'BIND_VR_LISTENER_SERVICE': 71, 'BIND_WALLPAPER': 72, 'BLUETOOTH': 73, 'BLUETOOTH_ADMIN': 74, 'BLUETOOTH_MAP': 75, 'BLUETOOTH_PRIVILEGED': 76, 'BLUETOOTH_STACK': 77, 'BRICK': 78, 'BROADCAST_CALLLOG_INFO': 79, 'BROADCAST_NETWORK_PRIVILEGED': 80, 'BROADCAST_PACKAGE_REMOVED': 81, 'BROADCAST_PHONE_ACCOUNT_REGISTRATION': 82, 'BROADCAST_SMS': 83, 'BROADCAST_STICKY': 84, 'BROADCAST_WAP_PUSH': 85, 'CACHE_CONTENT': 86, 'CALL_PRIVILEGED': 87, 'CAMERA_DISABLE_TRANSMIT_LED': 88, 'CAMERA_SEND_SYSTEM_EVENTS': 89, 'CAPTURE_AUDIO_HOTWORD': 90, 'CAPTURE_AUDIO_OUTPUT': 91, 'CAPTURE_SECURE_VIDEO_OUTPUT': 92, 'CAPTURE_TV_INPUT': 93, 'CAPTURE_VIDEO_OUTPUT': 94, 'CARRIER_FILTER_SMS': 95, 'CHANGE_APP_IDLE_STATE': 96, 'CHANGE_BACKGROUND_DATA_SETTING': 97, 'CHANGE_COMPONENT_ENABLED_STATE': 98, 'CHANGE_CONFIGURATION': 99, 'CHANGE_DEVICE_IDLE_TEMP_WHITELIST': 100, 'CHANGE_NETWORK_STATE': 101, 'CHANGE_WIFI_MULTICAST_STATE': 102, 'CHANGE_WIFI_STATE': 103, 'CHANGE_WIMAX_STATE': 104, 'CLEAR_APP_CACHE': 105, 'CLEAR_APP_GRANTED_URI_PERMISSIONS': 106, 'CLEAR_APP_USER_DATA': 107, 'CONFIGURE_DISPLAY_COLOR_TRANSFORM': 108, 'CONFIGURE_WIFI_DISPLAY': 109, 'CONFIRM_FULL_BACKUP': 110, 'CONNECTIVITY_INTERNAL': 111, 'CONTROL_INCALL_EXPERIENCE': 112, 'CONTROL_KEYGUARD': 113, 'CONTROL_LOCATION_UPDATES': 114, 'CONTROL_VPN': 115, 'CONTROL_WIFI_DISPLAY': 116, 'COPY_PROTECTED_DATA': 117, 'CREATE_USERS': 118, 'CRYPT_KEEPER': 119, 'DELETE_CACHE_FILES': 120, 'DELETE_PACKAGES': 121, 'DEVICE_POWER': 122, 'DIAGNOSTIC': 123, 'DISABLE_KEYGUARD': 124, 'DISPATCH_NFC_MESSAGE': 125, 'DISPATCH_PROVISIONING_MESSAGE': 126, 'DOWNLOAD_CACHE_NON_PURGEABLE': 127, 'DUMP': 128, 'DVB_DEVICE': 129, 'EXPAND_STATUS_BAR': 130, 'FACTORY_TEST': 131, 'FILTER_EVENTS': 132, 'FLASHLIGHT': 133, 'FORCE_BACK': 134, 'FORCE_STOP_PACKAGES': 135, 'FRAME_STATS': 136, 'FREEZE_SCREEN': 137, 'GET_ACCOUNTS_PRIVILEGED': 138, 'GET_APP_GRANTED_URI_PERMISSIONS': 139, 'GET_APP_OPS_STATS': 140, 'GET_DETAILED_TASKS': 141, 'GET_INTENT_SENDER_INTENT': 142, 'GET_PACKAGE_IMPORTANCE': 143, 'GET_PACKAGE_SIZE': 144, 'GET_PASSWORD': 145, 'GET_PROCESS_STATE_AND_OOM_SCORE': 146, 'GET_TASKS': 147, 'GET_TOP_ACTIVITY_INFO': 148, 'GLOBAL_SEARCH': 149, 'GLOBAL_SEARCH_CONTROL': 150, 'GRANT_RUNTIME_PERMISSIONS': 151, 'HARDWARE_TEST': 152, 'HDMI_CEC': 153, 'INJECT_EVENTS': 154, 'INSTALL_GRANT_RUNTIME_PERMISSIONS': 155, 'INSTALL_LOCATION_PROVIDER': 156, 'INSTALL_PACKAGES': 157, 'INTENT_FILTER_VERIFICATION_AGENT': 158, 'INTERACT_ACROSS_USERS': 159, 'INTERACT_ACROSS_USERS_FULL': 160, 'INTERNAL_SYSTEM_WINDOW': 161, 'INTERNET': 162, 'INVOKE_CARRIER_SETUP': 163, 'KILL_BACKGROUND_PROCESSES': 164, 'KILL_UID': 165, 'LAUNCH_TRUST_AGENT_SETTINGS': 166, 'LOCAL_MAC_ADDRESS': 167, 'LOCATION_HARDWARE': 168, 'LOOP_RADIO': 169, 'MANAGE_ACCOUNTS': 170, 'MANAGE_ACTIVITY_STACKS': 171, 'MANAGE_APP_OPS_RESTRICTIONS': 172, 'MANAGE_APP_TOKENS': 173, 'MANAGE_CA_CERTIFICATES': 174, 'MANAGE_DEVICE_ADMINS': 175, 'MANAGE_DOCUMENTS': 176, 'MANAGE_FINGERPRINT': 177, 'MANAGE_MEDIA_PROJECTION': 178, 'MANAGE_NETWORK_POLICY': 179, 'MANAGE_NOTIFICATIONS': 180, 'MANAGE_PROFILE_AND_DEVICE_OWNERS': 181, 'MANAGE_SOUND_TRIGGER': 182, 'MANAGE_USB': 183, 'MANAGE_USERS': 184, 'MANAGE_VOICE_KEYPHRASES': 185, 'MASTER_CLEAR': 186, 'MEDIA_CONTENT_CONTROL': 187, 'MODIFY_APPWIDGET_BIND_PERMISSIONS': 188, 'MODIFY_AUDIO_ROUTING': 189, 'MODIFY_AUDIO_SETTINGS': 190, 'MODIFY_CELL_BROADCASTS': 191, 'MODIFY_DAY_NIGHT_MODE': 192, 'MODIFY_NETWORK_ACCOUNTING': 193, 'MODIFY_PARENTAL_CONTROLS': 194, 'MODIFY_PHONE_STATE': 195, 'MOUNT_FORMAT_FILESYSTEMS': 196, 'MOUNT_UNMOUNT_FILESYSTEMS': 197, 'MOVE_PACKAGE': 198, 'NET_ADMIN': 199, 'NET_TUNNELING': 200, 'NFC': 201, 'NFC_HANDOVER_STATUS': 202, 'NOTIFY_PENDING_SYSTEM_UPDATE': 203, 'OBSERVE_GRANT_REVOKE_PERMISSIONS': 204, 'OEM_UNLOCK_STATE': 205, 'OVERRIDE_WIFI_CONFIG': 206, 'PACKAGE_USAGE_STATS': 207, 'PACKAGE_VERIFICATION_AGENT': 208, 'PACKET_KEEPALIVE_OFFLOAD': 209, 'PEERS_MAC_ADDRESS': 210, 'PERFORM_CDMA_PROVISIONING': 211, 'PERFORM_SIM_ACTIVATION': 212, 'PERSISTENT_ACTIVITY': 213, 'PROCESS_CALLLOG_INFO': 214, 'PROCESS_PHONE_ACCOUNT_REGISTRATION': 215, 'PROVIDE_TRUST_AGENT': 216, 'QUERY_DO_NOT_ASK_CREDENTIALS_ON_BOOT': 217, 'READ_BLOCKED_NUMBERS': 218, 'READ_DREAM_STATE': 219, 'READ_FRAME_BUFFER': 220, 'READ_INPUT_STATE': 221, 'READ_INSTALL_SESSIONS': 222, 'READ_LOGS': 223, 'READ_NETWORK_USAGE_HISTORY': 224, 'READ_OEM_UNLOCK_STATE': 225, 'READ_PRECISE_PHONE_STATE': 226, 'READ_PRIVILEGED_PHONE_STATE': 227, 'READ_PROFILE': 228, 'READ_SEARCH_INDEXABLES': 229, 'READ_SOCIAL_STREAM': 230, 'READ_SYNC_SETTINGS': 231, 'READ_SYNC_STATS': 232, 'READ_USER_DICTIONARY': 233, 'READ_WIFI_CREDENTIAL': 234, 'REAL_GET_TASKS': 235, 'REBOOT': 236, 'RECEIVE_BLUETOOTH_MAP': 237, 'RECEIVE_BOOT_COMPLETED': 238, 'RECEIVE_DATA_ACTIVITY_CHANGE': 239, 'RECEIVE_EMERGENCY_BROADCAST': 240, 'RECEIVE_MEDIA_RESOURCE_USAGE': 241, 'RECEIVE_STK_COMMANDS': 242, 'RECEIVE_WIFI_CREDENTIAL_CHANGE': 243, 'RECOVERY': 244, 'REGISTER_CALL_PROVIDER': 245, 'REGISTER_CONNECTION_MANAGER': 246, 'REGISTER_SIM_SUBSCRIPTION': 247, 'REGISTER_WINDOW_MANAGER_LISTENERS': 248, 'REMOTE_AUDIO_PLAYBACK': 249, 'REMOVE_DRM_CERTIFICATES': 250, 'REMOVE_TASKS': 251, 'REORDER_TASKS': 252, 'REQUEST_IGNORE_BATTERY_OPTIMIZATIONS': 253, 'REQUEST_INSTALL_PACKAGES': 254, 'RESET_FINGERPRINT_LOCKOUT': 255, 'RESET_SHORTCUT_MANAGER_THROTTLING': 256, 'RESTART_PACKAGES': 257, 'RETRIEVE_WINDOW_CONTENT': 258, 'RETRIEVE_WINDOW_TOKEN': 259, 'REVOKE_RUNTIME_PERMISSIONS': 260, 'SCORE_NETWORKS': 261, 'SEND_CALL_LOG_CHANGE': 262, 'SEND_DOWNLOAD_COMPLETED_INTENTS': 263, 'SEND_RESPOND_VIA_MESSAGE': 264, 'SEND_SMS_NO_CONFIRMATION': 265, 'SERIAL_PORT': 266, 'SET_ACTIVITY_WATCHER': 267, 'SET_ALWAYS_FINISH': 268, 'SET_ANIMATION_SCALE': 269, 'SET_DEBUG_APP': 270, 'SET_INPUT_CALIBRATION': 271, 'SET_KEYBOARD_LAYOUT': 272, 'SET_ORIENTATION': 273, 'SET_POINTER_SPEED': 274, 'SET_PREFERRED_APPLICATIONS': 275, 'SET_PROCESS_LIMIT': 276, 'SET_SCREEN_COMPATIBILITY': 277, 'SET_TIME': 278, 'SET_TIME_ZONE': 279, 'SET_WALLPAPER': 280, 'SET_WALLPAPER_COMPONENT': 281, 'SET_WALLPAPER_HINTS': 282, 'SHUTDOWN': 283, 'SIGNAL_PERSISTENT_PROCESSES': 284, 'START_ANY_ACTIVITY': 285, 'START_PRINT_SERVICE_CONFIG_ACTIVITY': 286, 'START_TASKS_FROM_RECENTS': 287, 'STATUS_BAR': 288, 'STATUS_BAR_SERVICE': 289, 'STOP_APP_SWITCHES': 290, 'STORAGE_INTERNAL': 291, 'SUBSCRIBED_FEEDS_READ': 292, 'SUBSCRIBED_FEEDS_WRITE': 293, 'SUBSTITUTE_NOTIFICATION_APP_NAME': 294, 'SYSTEM_ALERT_WINDOW': 295, 'TABLET_MODE': 296, 'TEMPORARY_ENABLE_ACCESSIBILITY': 297, 'TETHER_PRIVILEGED': 298, 'TRANSMIT_IR': 299, 'TRUST_LISTENER': 300, 'TV_INPUT_HARDWARE': 301, 'TV_VIRTUAL_REMOTE_CONTROLLER': 302, 'UPDATE_APP_OPS_STATS': 303, 'UPDATE_CONFIG': 304, 'UPDATE_DEVICE_STATS': 305, 'UPDATE_LOCK': 306, 'UPDATE_LOCK_TASK_PACKAGES': 307, 'USER_ACTIVITY': 308, 'USE_CREDENTIALS': 309, 'VIBRATE': 310, 'WAKE_LOCK': 311, 'WRITE_APN_SETTINGS': 312, 'WRITE_BLOCKED_NUMBERS': 313, 'WRITE_DREAM_STATE': 314, 'WRITE_GSERVICES': 315, 'WRITE_MEDIA_STORAGE': 316, 'WRITE_PROFILE': 317, 'WRITE_SECURE_SETTINGS': 318, 'WRITE_SETTINGS': 319, 'WRITE_SMS': 320, 'WRITE_SOCIAL_STREAM': 321, 'WRITE_SYNC_SETTINGS': 322, 'WRITE_USER_DICTIONARY': 323, 'ACCESS': 323, 'ACCESS_ASSISTED_GPS': 324, 'ACCESS_CELL_ID': 325, 'ACCESS_COARSE_LOCATION': 326, 'ACCESS_COARSE_UPDATES': 327, 'ACCESS_DRM': 328, 'ACCESS_FINE_LOCATION': 329, 'ACCESS_GPS': 330, 'ACCESS_INTENTS': 331, 'ACCESS_KUGOU_SERVICE': 332, 'ACCESS_LOCATION': 333, 'ACCESS_LOCATTON_MOCK_LOCATION': 334, 'ACCES_MOCK_LOCATION': 335, 'ACTION_IMAGE_CAPTURE': 336, 'ADD_SYSTEM_SERVICE': 337, 'BILLING': 338, 'BOOT_COMPLETED': 339, 'BROADCAST_PACKAGE_ADDED': 340, 'C2D_MESSAGE': 341, 'CALL_PHONE': 342, 'CAMERA': 343, 'CENTRAL_SERVICE_PERMISSION': 344, 'CHECK_LICENSE': 345, 'FULLSCREEN': 346, 'FULL_SCREEN': 347, 'GET_ACCOUNTS': 348, 'GOOGLE_AUTH': 349, 'INSTALL_DRM': 350, 'INSTALL_SHORTCUT': 351, 'LISTEN_CALL_STATE': 352, 'LOCATION': 353, 'NEW_OUTGOING_CALL': 354, 'PERMISSION': 355, 'PERMISSION_NAME': 356, 'PLUGIN': 357, 'PROCESS_CALL': 358, 'PROCESS_INCOMING_CALLS': 359, 'PROCESS_OUTGOING_CALLS': 360, 'RAISED_THREAD_PRIORITY': 361, 'READ_CALENDAR': 362, 'READ_CONTACTS': 363, 'READ_EXTERNAL_STORAGE': 364, 'READ_GMAIL': 365, 'READ_GSERVICES': 366, 'READ_HISTORY_BOOKMARKS': 367, 'READ_MMS': 368, 'READ_OWNER_DATA': 369, 'READ_PERMISSION': 370, 'READ_PHONE_STAT': 371, 'READ_PHONE_STATE': 372, 'READ_SECURE_SETTINGS': 373, 'READ_SETTINGS': 374, 'READ_SMS': 375, 'READ_WRITE': 376, 'RECEIVE': 377, 'RECEIVE_BOOT_CPMPLETED': 378, 'RECEIVE_MMS': 379, 'RECEIVE_SMS': 380, 'RECEIVE_WAP_PUSH': 381, 'RECORD_AUDIO': 382, 'RECORD_VIDEO': 383, 'SEND_SMS': 384, 'SET_ALARM': 385, 'UNINSTALL_SHORTCUT': 386, 'WIFI_LOCK': 387, 'WRITE_CALENDAR': 388, 'WRITE_CONTACTS': 389, 'WRITE_EXTERNAL_STORAGE': 390, 'WRITE_GMAIL': 391, 'WRITE_HISTORY_BOOKMARKS': 392, 'WRITE_OWNER_DATA': 393, 'WRITE_OWNER_FILE': 394, 'WRITE_PERMISSION': 395, 'WRITE_SECURE': 396}
drebin_features = {'ACCESS': 0, 'ACCESS_ASSISTED_GPS': 1, 'ACCESS_CACHE_FILESYSTEM': 2, 'ACCESS_CELL_ID': 3, 'ACCESS_CHECKIN_PROPERTIES': 4, 'ACCESS_COARSE_LOCATION': 5, 'ACCESS_COARSE_UPDATES': 6, 'ACCESS_DOWNLOAD_MANAGER': 7, 'ACCESS_DOWNLOAD_MANAGER_ADVANCED': 8, 'ACCESS_DRM': 9, 'ACCESS_FINE_LOCATION': 10, 'ACCESS_GPS': 11, 'ACCESS_INTENTS': 12, 'ACCESS_KUGOU_SERVICE': 13, 'ACCESS_LOCATION': 14, 'ACCESS_LOCATION_EXTRA_COMMANDS': 15, 'ACCESS_LOCATTON_MOCK_LOCATION': 16, 'ACCESS_MOCK_LOCATION': 17, 'ACCESS_NETWORK_STATE': 18, 'ACCESS_SURFACE_FLINGER': 19, 'ACCESS_WIFI_STATE': 20, 'ACCESS_WIMAX_STATE': 21, 'ACCES_MOCK_LOCATION': 22, 'ACCOUNT_MANAGER': 23, 'ACTION_IMAGE_CAPTURE': 24, 'ADD_SYSTEM_SERVICE': 25, 'AUTHENTICATE_ACCOUNTS': 26, 'BACKUP': 27, 'BATTERY_STATS': 28, 'BILLING': 29, 'BIND_APPWIDGET': 30, 'BIND_INPUT_METHOD': 31, 'BIND_WALLPAPER': 32, 'BLUETOOTH': 33, 'BLUETOOTH_ADMIN': 34, 'BOOT_COMPLETED': 35, 'BRICK': 36, 'BROADCAST_PACKAGE_ADDED': 37, 'BROADCAST_PACKAGE_REMOVED': 38, 'BROADCAST_SMS': 39, 'BROADCAST_STICKY': 40, 'BROADCAST_WAP_PUSH': 41, 'C2D_MESSAGE': 42, 'CALL_PHONE': 43, 'CALL_PRIVILEGED': 44, 'CAMERA': 45, 'CENTRAL_SERVICE_PERMISSION': 46, 'CHANGE_COMPONENT_ENABLED_STATE': 47, 'CHANGE_CONFIGURATION': 48, 'CHANGE_NETWORK_STATE': 49, 'CHANGE_WIFI_MULTICAST_STATE': 50, 'CHANGE_WIFI_STATE': 51, 'CHANGE_WIMAX_STATE': 52, 'CHECK_LICENSE': 53, 'CLEAR_APP_CACHE': 54, 'CLEAR_APP_USER_DATA': 55, 'CONTROL_LOCATION_UPDATES': 56, 'DELETE_CACHE_FILES': 57, 'DELETE_PACKAGES': 58, 'DEVICE_POWER': 59, 'DIAGNOSTIC': 60, 'DISABLE_KEYGUARD': 61, 'DUMP': 62, 'EXPAND_STATUS_BAR': 63, 'FACTORY_TEST': 64, 'FLASHLIGHT': 65, 'FORCE_BACK': 66, 'FORCE_STOP_PACKAGES': 67, 'FULLSCREEN': 68, 'FULL_SCREEN': 69, 'GET_ACCOUNTS': 70, 'GET_PACKAGE_SIZE': 71, 'GET_TASKS': 72, 'GLOBAL_SEARCH': 73, 'GLOBAL_SEARCH_CONTROL': 74, 'GOOGLE_AUTH': 75, 'HARDWARE_TEST': 76, 'INJECT_EVENTS': 77, 'INSTALL_DRM': 78, 'INSTALL_LOCATION_PROVIDER': 79, 'INSTALL_PACKAGES': 80, 'INSTALL_SHORTCUT': 81, 'INTERNAL_SYSTEM_WINDOW': 82, 'INTERNET': 83, 'KILL_BACKGROUND_PROCESSES': 84, 'LISTEN_CALL_STATE': 85, 'LOCATION': 86, 'MANAGE_ACCOUNTS': 87, 'MANAGE_APP_TOKENS': 88, 'MASTER_CLEAR': 89, 'MODIFY_AUDIO_SETTINGS': 90, 'MODIFY_PHONE_STATE': 91, 'MOUNT_FORMAT_FILESYSTEMS': 92, 'MOUNT_UNMOUNT_FILESYSTEMS': 93, 'NEW_OUTGOING_CALL': 94, 'NFC': 95, 'PERMISSION': 96, 'PERMISSION_NAME': 97, 'PERSISTENT_ACTIVITY': 98, 'PLUGIN': 99, 'PROCESS_CALL': 100, 'PROCESS_INCOMING_CALLS': 101, 'PROCESS_OUTGOING_CALLS': 102, 'RAISED_THREAD_PRIORITY': 103, 'READ_CALENDAR': 104, 'READ_CONTACTS': 105, 'READ_EXTERNAL_STORAGE': 106, 'READ_FRAME_BUFFER': 107, 'READ_GMAIL': 108, 'READ_GSERVICES': 109, 'READ_HISTORY_BOOKMARKS': 110, 'READ_INPUT_STATE': 111, 'READ_LOGS': 112, 'READ_MMS': 113, 'READ_OWNER_DATA': 114, 'READ_PERMISSION': 115, 'READ_PHONE_STAT': 116, 'READ_PHONE_STATE': 117, 'READ_SECURE_SETTINGS': 118, 'READ_SETTINGS': 119, 'READ_SMS': 120, 'READ_SYNC_SETTINGS': 121, 'READ_SYNC_STATS': 122, 'READ_USER_DICTIONARY': 123, 'READ_WRITE': 124, 'REBOOT': 125, 'RECEIVE': 126, 'RECEIVE_BOOT_COMPLETED': 127, 'RECEIVE_BOOT_CPMPLETED': 128, 'RECEIVE_MMS': 129, 'RECEIVE_SMS': 130, 'RECEIVE_WAP_PUSH': 131, 'RECORD_AUDIO': 132, 'RECORD_VIDEO': 133, 'REORDER_TASKS': 134, 'RESTART_PACKAGES': 135, 'SEND_DOWNLOAD_COMPLETED_INTENTS': 136, 'SEND_SMS': 137, 'SET_ACTIVITY_WATCHER': 138, 'SET_ALARM': 139, 'SET_ALWAYS_FINISH': 140, 'SET_ANIMATION_SCALE': 141, 'SET_DEBUG_APP': 142, 'SET_ORIENTATION': 143, 'SET_PREFERRED_APPLICATIONS': 144, 'SET_PROCESS_LIMIT': 145, 'SET_TIME_ZONE': 146, 'SET_WALLPAPER': 147, 'SET_WALLPAPER_COMPONENT': 148, 'SET_WALLPAPER_HINTS': 149, 'SIGNAL_PERSISTENT_PROCESSES': 150, 'STATUS_BAR': 151, 'SUBSCRIBED_FEEDS_READ': 152, 'SUBSCRIBED_FEEDS_WRITE': 153, 'SYSTEM_ALERT_WINDOW': 154, 'UNINSTALL_SHORTCUT': 155, 'UPDATE_DEVICE_STATS': 156, 'USE_CREDENTIALS': 157, 'VIBRATE': 158, 'WAKE_LOCK': 159, 'WIFI_LOCK': 160, 'WRITE_APN_SETTINGS': 161, 'WRITE_CALENDAR': 162, 'WRITE_CONTACTS': 163, 'WRITE_EXTERNAL_STORAGE': 164, 'WRITE_GMAIL': 165, 'WRITE_GSERVICES': 166, 'WRITE_HISTORY_BOOKMARKS': 167, 'WRITE_MEDIA_STORAGE': 168, 'WRITE_OWNER_DATA': 169, 'WRITE_OWNER_FILE': 170, 'WRITE_PERMISSION': 171, 'WRITE_SECURE': 172, 'WRITE_SECURE_SETTINGS': 173, 'WRITE_SETTINGS': 174, 'WRITE_SMS': 175, 'WRITE_SYNC_SETTINGS': 176}
map_num = {'00_apps': 0, '0_apps': 0, 'AccuTrack': 1, 'Ackposts': 2, 'Acnetdoor': 3, 'Adrd': 4, 'Adsms': 5, 'Aks': 6, 'Ansca': 7, 'Antares': 8, 'Anti': 9, 'Anudow': 10, 'Arspam': 11, 'BaseBridge': 12, 'BeanBot': 13, 'Bgserv': 14, 'Biige': 15, 'Booster': 16, 'Bosm': 17, 'Boxer': 18, 'Cawitt': 19, 'CellShark': 20, 'CellSpy': 21, 'Ceshark': 22, 'CgFinder': 23, 'Coogos': 24, 'Copycat': 25, 'Cosha': 26, 'CrWind': 27, 'Dabom': 28, 'Dialer': 29, 'Dogowar': 30, 'Dougalek': 31, 'DroidDream': 32, 'DroidKungFu': 33, 'DroidRooter': 34, 'DroidSheep': 35, 'EICAR-Test-File': 36, 'EWalls': 37, 'Exploit.RageCage': 38, 'ExploitLinuxLotoor': 39, 'Faceniff': 40, 'FakeDoc': 41, 'FakeFlash': 42, 'FakeInstaller': 43, 'Fakelogo': 44, 'FakeNefix': 45, 'Fakengry': 46, 'FakePlayer': 47, 'FakeRun': 48, 'FakeTimer': 49, 'Fakeview': 50, 'FarMap': 51, 'Fatakr': 52, 'Fauxcopy': 53, 'Fidall': 54, 'FinSpy': 55, 'Fjcon': 56, 'Flexispy': 57, 'FoCobers': 58, 'Foncy': 59, 'Fsm': 60, 'Fujacks': 61, 'Gamex': 62, 'Gapev': 63, 'Gappusin': 64, 'Gasms': 65, 'Geinimi': 66, 'Generic': 67, 'GGtrack': 68, 'GinMaster': 69, 'GlodEagl': 70, 'Glodream': 71, 'Gmuse': 72, 'Gonca': 73, 'GPSpy': 74, 'Hamob': 75, 'Hispo': 76, 'Iconosys': 77, 'Imlog': 78, 'Jifake': 79, 'JS': 80, 'Exploit-DynSrc': 81, 'JSmsHider': 82, 'Kidlogger': 83, 'Kiser': 84, 'Kmin': 85, 'Koomer': 86, 'Ksapp': 87, 'Lemon': 88, 'LifeMon': 89, 'Loicdos': 90, 'Loozfon': 91, 'Luckycat': 92, 'Lypro': 93, 'Maistealer': 94, 'Mania': 95, 'Maxit': 96, 'MMarketPay': 97, 'Mobilespy': 98, 'MobileTx': 99, 'Mobinauten': 100, 'Mobsquz': 101, 'Moghava': 102, 'MTracker': 103, 'Nandrobox': 104, 'Netisend': 105, 'Nickspy': 106, 'NickyRCP': 107, 'Nisev': 108, 'Nyleaker': 109, 'Opfake': 110, 'PdaSpy': 111, 'Penetho': 112, 'Pirater': 113, 'Pirates': 114, 'PJApps': 115, 'Placms': 116, 'Plankton': 117, 'Proreso': 118, 'Qicsom': 119, 'QPlus': 120, 'Raden': 121, 'RATC': 122, 'RediAssi': 123, 'Replicator': 124, 'Rooter': 125, 'RootSmart': 126, 'RuFraud': 127, 'SafeKidZone': 128, 'Saiva': 129, 'Sakezon': 130, 'Sdisp': 131, 'SeaWeth': 132, 'SendPay': 133, 'SerBG': 134, 'SheriDroid': 135, 'SmForw': 136, 'SMSBomber': 137, 'Smspacem': 138, 'SMSreg': 139, 'SMSSend': 140, 'SmsSpy': 141, 'SmsWatcher': 142, 'SMSZombie': 143, 'Sonus': 144, 'Spitmo': 145, 'Spy.GoneSixty': 146, 'Spy.ImLog': 147, 'SpyBubble': 148, 'SpyHasb': 149, 'SpyMob': 150, 'Spyoo': 151, 'SpyPhone': 152, 'Spyset': 153, 'Ssmsp': 154, 'Stealer': 155, 'Stealthcell': 156, 'Steek': 157, 'Stiniter': 158, 'SuBatt': 159, 'Tapsnake': 160, 'Tesbo': 161, 'TheftAware': 162, 'TigerBot': 163, 'Trackplus': 164, 'TrojanSMS.Boxer.AQ': 165, 'TrojanSMS.Denofow': 166, 'TrojanSMS.Hippo': 167, 'TrojanSMS.Stealer': 168, 'Typstu': 169, 'Updtbot': 170, 'UpdtKiller': 171, 'Vdloader': 172, 'Vidro': 173, 'Whapsni': 174, 'Xsider': 175, 'YcChar': 176, 'Yzhc': 177, 'Zitmo': 178, 'Zsone': 179}
api = {'http://api.airpush.com': 0, 'http://app.wapx.cn': 1, 'http://client.go360days.com': 2, 'http://schemas.android.com': 3, 'http://10.0.0.172': 4, 'http://market.android.com': 5, 'http://r2.adwo.com': 6, 'https://market.android.com': 7, 'http://maps.google.com': 8, 'http://gad.ju6666.com': 9, 'http://ads.wapx.cn': 10, 'http://beta.vpon.com': 11, 'http://cn.ad.adon.vpon.com': 12, 'http://tw.ad.adon.vpon.com': 13, 'http://beta.airpush.com': 14, 'http://ads.waps.cn': 15, 'http://www.gstatic.com': 16, 'http://www.w3.org': 17, 'http://www.adwo.com': 18, 'http://adtest.adwo.com': 19, 'http://en.wikipedia.org': 20, 'http://www.searchmobileonline.com': 21, 'http://app.waps.cn': 22, 'http://fwd.3g.qq.com:8080': 23, 'http://a.admob.com': 24, 'http://ad.leadbolt.net': 25, 'http://ad.leadboltapps.net': 26, 'http://www.vpon.com': 27, 'http://axy.waplove.cn:8080': 28, 'http://cfg.adsmogo.com': 29, 'http://ade.wooboo.com.cn': 30, 'https://ws.tapjoyads.com': 31, 'http://googleads.g.doubleclick.net': 32, 'http://mm.admob.com': 33, 'http://www.youtube.com': 34, 'http://cus.adsmogo.com': 35, 'http://api.go108.cn': 36, 'http://www.umeng.com': 37, 'http://smsreplier.net': 38, 'http://clk.adsmogo.com': 39, 'http://imp.adsmogo.com': 40, 'http://mob.guohead.com': 41, 'http://req.adsmogo.com': 42, 'http://schemas.xmlsoap.org': 43, 'http://blk.adsmogo.com': 44, 'http://data.mobclix.com': 45, 'http://www.adsmogo.com': 46, 'https://play.google.com': 47, 'http://media.admob.com': 48, 'http://r.domob.cn': 49, 'http://www.umeng.co': 50, 'http://play.google.com': 51, 'http://su.5k3g.com': 52, 'http://maps.google': 53, 'http://twitter.com': 54, 'http://e.domob.cn': 55, 'http://androidsdk.ads.mp.mydas.mobi': 56, 'http://xmlpull.org': 57, 'http://sites.google.com': 58, 'http://d.wiyun.com': 59, 'http://211.99.197.56': 60, 'http://www.facebook.com': 61, 'http://www.google.com': 62, 'http://www.go108.com.cn': 63, 'http://androids-market.ru': 64, 'http://www.apperhand.com': 65, 'http://appnotify.forehandmedia.com': 66, 'http://ma.mkhoj.com': 67, 'https://graph.facebook.com': 68, 'http://client.139vps.com': 69, 'https://www.paypal.com': 70, 'http://wp.ysler.com': 71, 'http://c.admob.com': 72, 'http://www.googleadservices.com': 73, 'https://api.airpush.com': 74, 'http://10.0.0.172:80': 75, 'http://mobile.91.com': 76, 'http://ditu.google.com': 77, 'http://r.admob.com': 78, 'http://open.t.qq.com': 79, 'http://api.twitter.com': 80, 'http://battery-updates-android.net': 81, 'http://api.admob.com': 82, 'http://www.applovin.com': 83, 'https://bugsense.appspot.com': 84, 'http://ad.flurry.com': 85, 'http://d.applovin.com': 86, 'http://api.mixpanel.com': 87, 'http://mobile.tx.com.cn:8081': 88, 'http://search.gongfu-android.com:8511': 89, 'http://blackflyday.com': 90, 'http://gw.youmi.net': 91, 'http://domaindev.51widgets.com': 92, 'http://developer.android.com': 93, 'http://rest.tx.com.cn': 94, 'http://softfile.3g.qq.com:8080': 95, 'http://moba.rsigma.com': 96, 'http://www.androiddoctor.com': 97, 'https://chart.googleapis.com': 98, 'http://sigma.sgadtracker.com': 99, 'http://50.116.39.44': 100, 'http://ditu.google.cn': 101, 'http://www.tvchannelsfree.com': 102, 'http://xml.org': 103, 'http://client.mustmobile.com': 104, 'http://ads.senddroid.com': 105, 'http://push.senddroid.com': 106, 'https://m.facebook.com': 107, 'http://cvt.mydas.mobi': 108, 'http://wap.casee.cn': 109, 'http://www.appmedia.cn': 110, 'https://data.flurry.com': 111, 'http://data.flurry.com': 112, 'http://amob.acs86.com': 113, 'http://feedback.whalecloud.com': 114, 'http://my.mobfox.com': 115, 'http://rukodelniza.ru': 116, 'http://purl.org': 117, 'http://www.mojiva.com': 118, 'http://cfg.adsmogo.mobi': 119, 'http://cfg.adsmogo.net': 120, 'http://cfg.adsmogo.org': 121, 'http://millennialmedia.com': 122, 'http://twitter4j.org': 123, 'https://api.facebook.com': 124, 'http://ads.mp.mydas.mobi': 125, 'http://222.73.127.57:10670': 126, 'http://www.google.cn': 127, 'http://proxy.youdraw.cn': 128, 'http://yandex.ru': 129, 'http://jabber.org': 130, 'http://wap.soso.com': 131, 'http://mmsc.monternet.com': 132, 'http://code.google.com': 133, 'http://wps.appscolor.net': 134, 'http://ad.gongfu-android.com:7500': 135, 'http://kaixinai.com': 136, 'http://api.t.sina.com.cn': 137, 'http://cus.adsmogo.mobi': 138, 'http://cus.adsmogo.net': 139, 'http://cus.adsmogo.org': 140, 'http://m.tashequ.com': 141, 'http://www.adview.cn': 142, 'http://e.admob.com': 143, 'http://www.winads.cn': 144, 'http://lebar.gicp.net': 145, 'http://ns.adobe.com': 146, 'http://www.cs.caltech.edu': 147, 'http://www.weiguan.com': 148, 'https://www.facebook.com': 149, 'http://a.applovin.com': 150, 'http://activeqq.3g.qq.com': 151, 'http://schemas.applovin.com': 152, 'http://static.youmi.net': 153, 'https://api.scoreloop.com': 154, 'http://219.234.85.214': 155, 'http://ma.inmobi.com': 156, 'http://www.droidsettings.com': 157, 'http://www.wimolife.com': 158, 'http://developers.facebook.com': 159, 'http://mmsc.vnet.mobi': 160, 'http://soft.sj.91.com': 161, 'http://www.5j5l.com': 162, 'http://schemas.openxmlformats.org': 163, 'https://dev.twitter.com': 164, 'http://ads.mobclix.com': 165, 'http://www.mobclix.com': 166, 'http://log.ysler.com': 167, 'http://privacy-policy.truste.com': 168, 'http://vc.mobclix.com': 169, 'http://i.w.inmobi.com': 170, 'http://sdkstatic.heyzap.com': 171, 'http://wangwang8080.gicp.net': 172, 'http://assets.zestadz.com': 173, 'https://mobile.twitter.com': 174, 'http://61.145.124.93': 175, 'http://kawa.gnu.org': 176, 'http://status.twitter.com': 177, 'http://yusuke.homeip.net': 178, 'https://roa.myspace.com': 179, 'http://ads.lmmob.com': 180, 'http://91.213.175.176': 181, 'http://ad.jiemai-tech.com:7500': 182, 'http://appinvtinywebdb.appspot.com': 183, 'http://smsreplier.com': 184, 'http://cn.api.vpon.com': 185, 'http://hot.coolcode.org': 186, 'http://met.adwhirl.com': 187, 'http://162.105.131.113': 188, 'http://a.mobclix.com': 189, 'http://client.shu8.cn': 190, 'http://schemas.google.com': 191, 'http://blog.z.qq.com': 192, 'http://kiss.3g.qq.com': 193, 'http://www.baidu.com': 194, 'http://revmob.com': 195, 'http://www.apple.com': 196, 'http://adfonic.net': 197, 'http://wap.baidu.com': 198, 'http://d.91.com': 199, 'http://mjoy.91.com': 200, 'http://www.pixeltrack66.com': 201, 'http://pagead2.googlesyndication.com': 202, 'http://www.androidhat.org': 203, 'http://www.android-supermarket.com': 204}
full_api_feature = {'ACCESS_ALL_DOWNLOADS': 0, 'ACCESS_BLUETOOTH_SHARE': 1, 'ACCESS_CACHE_FILESYSTEM': 2, 'ACCESS_CHECKIN_PROPERTIES': 3, 'ACCESS_CONTENT_PROVIDERS_EXTERNALLY': 4, 'ACCESS_DOWNLOAD_MANAGER': 5, 'ACCESS_DOWNLOAD_MANAGER_ADVANCED': 6, 'ACCESS_DRM_CERTIFICATES': 7, 'ACCESS_EPHEMERAL_APPS': 8, 'ACCESS_FM_RADIO': 9, 'ACCESS_INPUT_FLINGER': 10, 'ACCESS_KEYGUARD_SECURE_STORAGE': 11, 'ACCESS_LOCATION_EXTRA_COMMANDS': 12, 'ACCESS_MOCK_LOCATION': 13, 'ACCESS_MTP': 14, 'ACCESS_NETWORK_CONDITIONS': 15, 'ACCESS_NETWORK_STATE': 16, 'ACCESS_NOTIFICATIONS': 17, 'ACCESS_NOTIFICATION_POLICY': 18, 'ACCESS_PDB_STATE': 19, 'ACCESS_SURFACE_FLINGER': 20, 'ACCESS_VOICE_INTERACTION_SERVICE': 21, 'ACCESS_VR_MANAGER': 22, 'ACCESS_WIFI_STATE': 23, 'ACCESS_WIMAX_STATE': 24, 'ACCOUNT_MANAGER': 25, 'ALLOW_ANY_CODEC_FOR_PLAYBACK': 26, 'ASEC_ACCESS': 27, 'ASEC_CREATE': 28, 'ASEC_DESTROY': 29, 'ASEC_MOUNT_UNMOUNT': 30, 'ASEC_RENAME': 31, 'AUTHENTICATE_ACCOUNTS': 32, 'BACKUP': 33, 'BATTERY_STATS': 34, 'BIND_ACCESSIBILITY_SERVICE': 35, 'BIND_APPWIDGET': 36, 'BIND_CARRIER_MESSAGING_SERVICE': 37, 'BIND_CARRIER_SERVICES': 38, 'BIND_CHOOSER_TARGET_SERVICE': 39, 'BIND_CONDITION_PROVIDER_SERVICE': 40, 'BIND_CONNECTION_SERVICE': 41, 'BIND_DEVICE_ADMIN': 42, 'BIND_DIRECTORY_SEARCH': 43, 'BIND_DREAM_SERVICE': 44, 'BIND_INCALL_SERVICE': 45, 'BIND_INPUT_METHOD': 46, 'BIND_INTENT_FILTER_VERIFIER': 47, 'BIND_JOB_SERVICE': 48, 'BIND_KEYGUARD_APPWIDGET': 49, 'BIND_MIDI_DEVICE_SERVICE': 50, 'BIND_NFC_SERVICE': 51, 'BIND_NOTIFICATION_LISTENER_SERVICE': 52, 'BIND_NOTIFICATION_RANKER_SERVICE': 53, 'BIND_PACKAGE_VERIFIER': 54, 'BIND_PRINT_RECOMMENDATION_SERVICE': 55, 'BIND_PRINT_SERVICE': 56, 'BIND_PRINT_SPOOLER_SERVICE': 57, 'BIND_QUICK_SETTINGS_TILE': 58, 'BIND_REMOTEVIEWS': 59, 'BIND_REMOTE_DISPLAY': 60, 'BIND_ROUTE_PROVIDER': 61, 'BIND_RUNTIME_PERMISSION_PRESENTER_SERVICE': 62, 'BIND_SCREENING_SERVICE': 63, 'BIND_TELECOM_CONNECTION_SERVICE': 64, 'BIND_TEXT_SERVICE': 65, 'BIND_TRUST_AGENT': 66, 'BIND_TV_INPUT': 67, 'BIND_TV_REMOTE_SERVICE': 68, 'BIND_VOICE_INTERACTION': 69, 'BIND_VPN_SERVICE': 70, 'BIND_VR_LISTENER_SERVICE': 71, 'BIND_WALLPAPER': 72, 'BLUETOOTH': 73, 'BLUETOOTH_ADMIN': 74, 'BLUETOOTH_MAP': 75, 'BLUETOOTH_PRIVILEGED': 76, 'BLUETOOTH_STACK': 77, 'BRICK': 78, 'BROADCAST_CALLLOG_INFO': 79, 'BROADCAST_NETWORK_PRIVILEGED': 80, 'BROADCAST_PACKAGE_REMOVED': 81, 'BROADCAST_PHONE_ACCOUNT_REGISTRATION': 82, 'BROADCAST_SMS': 83, 'BROADCAST_STICKY': 84, 'BROADCAST_WAP_PUSH': 85, 'CACHE_CONTENT': 86, 'CALL_PRIVILEGED': 87, 'CAMERA_DISABLE_TRANSMIT_LED': 88, 'CAMERA_SEND_SYSTEM_EVENTS': 89, 'CAPTURE_AUDIO_HOTWORD': 90, 'CAPTURE_AUDIO_OUTPUT': 91, 'CAPTURE_SECURE_VIDEO_OUTPUT': 92, 'CAPTURE_TV_INPUT': 93, 'CAPTURE_VIDEO_OUTPUT': 94, 'CARRIER_FILTER_SMS': 95, 'CHANGE_APP_IDLE_STATE': 96, 'CHANGE_BACKGROUND_DATA_SETTING': 97, 'CHANGE_COMPONENT_ENABLED_STATE': 98, 'CHANGE_CONFIGURATION': 99, 'CHANGE_DEVICE_IDLE_TEMP_WHITELIST': 100, 'CHANGE_NETWORK_STATE': 101, 'CHANGE_WIFI_MULTICAST_STATE': 102, 'CHANGE_WIFI_STATE': 103, 'CHANGE_WIMAX_STATE': 104, 'CLEAR_APP_CACHE': 105, 'CLEAR_APP_GRANTED_URI_PERMISSIONS': 106, 'CLEAR_APP_USER_DATA': 107, 'CONFIGURE_DISPLAY_COLOR_TRANSFORM': 108, 'CONFIGURE_WIFI_DISPLAY': 109, 'CONFIRM_FULL_BACKUP': 110, 'CONNECTIVITY_INTERNAL': 111, 'CONTROL_INCALL_EXPERIENCE': 112, 'CONTROL_KEYGUARD': 113, 'CONTROL_LOCATION_UPDATES': 114, 'CONTROL_VPN': 115, 'CONTROL_WIFI_DISPLAY': 116, 'COPY_PROTECTED_DATA': 117, 'CREATE_USERS': 118, 'CRYPT_KEEPER': 119, 'DELETE_CACHE_FILES': 120, 'DELETE_PACKAGES': 121, 'DEVICE_POWER': 122, 'DIAGNOSTIC': 123, 'DISABLE_KEYGUARD': 124, 'DISPATCH_NFC_MESSAGE': 125, 'DISPATCH_PROVISIONING_MESSAGE': 126, 'DOWNLOAD_CACHE_NON_PURGEABLE': 127, 'DUMP': 128, 'DVB_DEVICE': 129, 'EXPAND_STATUS_BAR': 130, 'FACTORY_TEST': 131, 'FILTER_EVENTS': 132, 'FLASHLIGHT': 133, 'FORCE_BACK': 134, 'FORCE_STOP_PACKAGES': 135, 'FRAME_STATS': 136, 'FREEZE_SCREEN': 137, 'GET_ACCOUNTS_PRIVILEGED': 138, 'GET_APP_GRANTED_URI_PERMISSIONS': 139, 'GET_APP_OPS_STATS': 140, 'GET_DETAILED_TASKS': 141, 'GET_INTENT_SENDER_INTENT': 142, 'GET_PACKAGE_IMPORTANCE': 143, 'GET_PACKAGE_SIZE': 144, 'GET_PASSWORD': 145, 'GET_PROCESS_STATE_AND_OOM_SCORE': 146, 'GET_TASKS': 147, 'GET_TOP_ACTIVITY_INFO': 148, 'GLOBAL_SEARCH': 149, 'GLOBAL_SEARCH_CONTROL': 150, 'GRANT_RUNTIME_PERMISSIONS': 151, 'HARDWARE_TEST': 152, 'HDMI_CEC': 153, 'INJECT_EVENTS': 154, 'INSTALL_GRANT_RUNTIME_PERMISSIONS': 155, 'INSTALL_LOCATION_PROVIDER': 156, 'INSTALL_PACKAGES': 157, 'INTENT_FILTER_VERIFICATION_AGENT': 158, 'INTERACT_ACROSS_USERS': 159, 'INTERACT_ACROSS_USERS_FULL': 160, 'INTERNAL_SYSTEM_WINDOW': 161, 'INTERNET': 162, 'INVOKE_CARRIER_SETUP': 163, 'KILL_BACKGROUND_PROCESSES': 164, 'KILL_UID': 165, 'LAUNCH_TRUST_AGENT_SETTINGS': 166, 'LOCAL_MAC_ADDRESS': 167, 'LOCATION_HARDWARE': 168, 'LOOP_RADIO': 169, 'MANAGE_ACCOUNTS': 170, 'MANAGE_ACTIVITY_STACKS': 171, 'MANAGE_APP_OPS_RESTRICTIONS': 172, 'MANAGE_APP_TOKENS': 173, 'MANAGE_CA_CERTIFICATES': 174, 'MANAGE_DEVICE_ADMINS': 175, 'MANAGE_DOCUMENTS': 176, 'MANAGE_FINGERPRINT': 177, 'MANAGE_MEDIA_PROJECTION': 178, 'MANAGE_NETWORK_POLICY': 179, 'MANAGE_NOTIFICATIONS': 180, 'MANAGE_PROFILE_AND_DEVICE_OWNERS': 181, 'MANAGE_SOUND_TRIGGER': 182, 'MANAGE_USB': 183, 'MANAGE_USERS': 184, 'MANAGE_VOICE_KEYPHRASES': 185, 'MASTER_CLEAR': 186, 'MEDIA_CONTENT_CONTROL': 187, 'MODIFY_APPWIDGET_BIND_PERMISSIONS': 188, 'MODIFY_AUDIO_ROUTING': 189, 'MODIFY_AUDIO_SETTINGS': 190, 'MODIFY_CELL_BROADCASTS': 191, 'MODIFY_DAY_NIGHT_MODE': 192, 'MODIFY_NETWORK_ACCOUNTING': 193, 'MODIFY_PARENTAL_CONTROLS': 194, 'MODIFY_PHONE_STATE': 195, 'MOUNT_FORMAT_FILESYSTEMS': 196, 'MOUNT_UNMOUNT_FILESYSTEMS': 197, 'MOVE_PACKAGE': 198, 'NET_ADMIN': 199, 'NET_TUNNELING': 200, 'NFC': 201, 'NFC_HANDOVER_STATUS': 202, 'NOTIFY_PENDING_SYSTEM_UPDATE': 203, 'OBSERVE_GRANT_REVOKE_PERMISSIONS': 204, 'OEM_UNLOCK_STATE': 205, 'OVERRIDE_WIFI_CONFIG': 206, 'PACKAGE_USAGE_STATS': 207, 'PACKAGE_VERIFICATION_AGENT': 208, 'PACKET_KEEPALIVE_OFFLOAD': 209, 'PEERS_MAC_ADDRESS': 210, 'PERFORM_CDMA_PROVISIONING': 211, 'PERFORM_SIM_ACTIVATION': 212, 'PERSISTENT_ACTIVITY': 213, 'PROCESS_CALLLOG_INFO': 214, 'PROCESS_PHONE_ACCOUNT_REGISTRATION': 215, 'PROVIDE_TRUST_AGENT': 216, 'QUERY_DO_NOT_ASK_CREDENTIALS_ON_BOOT': 217, 'READ_BLOCKED_NUMBERS': 218, 'READ_DREAM_STATE': 219, 'READ_FRAME_BUFFER': 220, 'READ_INPUT_STATE': 221, 'READ_INSTALL_SESSIONS': 222, 'READ_LOGS': 223, 'READ_NETWORK_USAGE_HISTORY': 224, 'READ_OEM_UNLOCK_STATE': 225, 'READ_PRECISE_PHONE_STATE': 226, 'READ_PRIVILEGED_PHONE_STATE': 227, 'READ_PROFILE': 228, 'READ_SEARCH_INDEXABLES': 229, 'READ_SOCIAL_STREAM': 230, 'READ_SYNC_SETTINGS': 231, 'READ_SYNC_STATS': 232, 'READ_USER_DICTIONARY': 233, 'READ_WIFI_CREDENTIAL': 234, 'REAL_GET_TASKS': 235, 'REBOOT': 236, 'RECEIVE_BLUETOOTH_MAP': 237, 'RECEIVE_BOOT_COMPLETED': 238, 'RECEIVE_DATA_ACTIVITY_CHANGE': 239, 'RECEIVE_EMERGENCY_BROADCAST': 240, 'RECEIVE_MEDIA_RESOURCE_USAGE': 241, 'RECEIVE_STK_COMMANDS': 242, 'RECEIVE_WIFI_CREDENTIAL_CHANGE': 243, 'RECOVERY': 244, 'REGISTER_CALL_PROVIDER': 245, 'REGISTER_CONNECTION_MANAGER': 246, 'REGISTER_SIM_SUBSCRIPTION': 247, 'REGISTER_WINDOW_MANAGER_LISTENERS': 248, 'REMOTE_AUDIO_PLAYBACK': 249, 'REMOVE_DRM_CERTIFICATES': 250, 'REMOVE_TASKS': 251, 'REORDER_TASKS': 252, 'REQUEST_IGNORE_BATTERY_OPTIMIZATIONS': 253, 'REQUEST_INSTALL_PACKAGES': 254, 'RESET_FINGERPRINT_LOCKOUT': 255, 'RESET_SHORTCUT_MANAGER_THROTTLING': 256, 'RESTART_PACKAGES': 257, 'RETRIEVE_WINDOW_CONTENT': 258, 'RETRIEVE_WINDOW_TOKEN': 259, 'REVOKE_RUNTIME_PERMISSIONS': 260, 'SCORE_NETWORKS': 261, 'SEND_CALL_LOG_CHANGE': 262, 'SEND_DOWNLOAD_COMPLETED_INTENTS': 263, 'SEND_RESPOND_VIA_MESSAGE': 264, 'SEND_SMS_NO_CONFIRMATION': 265, 'SERIAL_PORT': 266, 'SET_ACTIVITY_WATCHER': 267, 'SET_ALWAYS_FINISH': 268, 'SET_ANIMATION_SCALE': 269, 'SET_DEBUG_APP': 270, 'SET_INPUT_CALIBRATION': 271, 'SET_KEYBOARD_LAYOUT': 272, 'SET_ORIENTATION': 273, 'SET_POINTER_SPEED': 274, 'SET_PREFERRED_APPLICATIONS': 275, 'SET_PROCESS_LIMIT': 276, 'SET_SCREEN_COMPATIBILITY': 277, 'SET_TIME': 278, 'SET_TIME_ZONE': 279, 'SET_WALLPAPER': 280, 'SET_WALLPAPER_COMPONENT': 281, 'SET_WALLPAPER_HINTS': 282, 'SHUTDOWN': 283, 'SIGNAL_PERSISTENT_PROCESSES': 284, 'START_ANY_ACTIVITY': 285, 'START_PRINT_SERVICE_CONFIG_ACTIVITY': 286, 'START_TASKS_FROM_RECENTS': 287, 'STATUS_BAR': 288, 'STATUS_BAR_SERVICE': 289, 'STOP_APP_SWITCHES': 290, 'STORAGE_INTERNAL': 291, 'SUBSCRIBED_FEEDS_READ': 292, 'SUBSCRIBED_FEEDS_WRITE': 293, 'SUBSTITUTE_NOTIFICATION_APP_NAME': 294, 'SYSTEM_ALERT_WINDOW': 295, 'TABLET_MODE': 296, 'TEMPORARY_ENABLE_ACCESSIBILITY': 297, 'TETHER_PRIVILEGED': 298, 'TRANSMIT_IR': 299, 'TRUST_LISTENER': 300, 'TV_INPUT_HARDWARE': 301, 'TV_VIRTUAL_REMOTE_CONTROLLER': 302, 'UPDATE_APP_OPS_STATS': 303, 'UPDATE_CONFIG': 304, 'UPDATE_DEVICE_STATS': 305, 'UPDATE_LOCK': 306, 'UPDATE_LOCK_TASK_PACKAGES': 307, 'USER_ACTIVITY': 308, 'USE_CREDENTIALS': 309, 'VIBRATE': 310, 'WAKE_LOCK': 311, 'WRITE_APN_SETTINGS': 312, 'WRITE_BLOCKED_NUMBERS': 313, 'WRITE_DREAM_STATE': 314, 'WRITE_GSERVICES': 315, 'WRITE_MEDIA_STORAGE': 316, 'WRITE_PROFILE': 317, 'WRITE_SECURE_SETTINGS': 318, 'WRITE_SETTINGS': 319, 'WRITE_SMS': 320, 'WRITE_SOCIAL_STREAM': 321, 'WRITE_SYNC_SETTINGS': 322, 'WRITE_USER_DICTIONARY': 323, 'ACCESS': 323, 'ACCESS_ASSISTED_GPS': 324, 'ACCESS_CELL_ID': 325, 'ACCESS_COARSE_LOCATION': 326, 'ACCESS_COARSE_UPDATES': 327, 'ACCESS_DRM': 328, 'ACCESS_FINE_LOCATION': 329, 'ACCESS_GPS': 330, 'ACCESS_INTENTS': 331, 'ACCESS_KUGOU_SERVICE': 332, 'ACCESS_LOCATION': 333, 'ACCESS_LOCATTON_MOCK_LOCATION': 334, 'ACCES_MOCK_LOCATION': 335, 'ACTION_IMAGE_CAPTURE': 336, 'ADD_SYSTEM_SERVICE': 337, 'BILLING': 338, 'BOOT_COMPLETED': 339, 'BROADCAST_PACKAGE_ADDED': 340, 'C2D_MESSAGE': 341, 'CALL_PHONE': 342, 'CAMERA': 343, 'CENTRAL_SERVICE_PERMISSION': 344, 'CHECK_LICENSE': 345, 'FULLSCREEN': 346, 'FULL_SCREEN': 347, 'GET_ACCOUNTS': 348, 'GOOGLE_AUTH': 349, 'INSTALL_DRM': 350, 'INSTALL_SHORTCUT': 351, 'LISTEN_CALL_STATE': 352, 'LOCATION': 353, 'NEW_OUTGOING_CALL': 354, 'PERMISSION': 355, 'PERMISSION_NAME': 356, 'PLUGIN': 357, 'PROCESS_CALL': 358, 'PROCESS_INCOMING_CALLS': 359, 'PROCESS_OUTGOING_CALLS': 360, 'RAISED_THREAD_PRIORITY': 361, 'READ_CALENDAR': 362, 'READ_CONTACTS': 363, 'READ_EXTERNAL_STORAGE': 364, 'READ_GMAIL': 365, 'READ_GSERVICES': 366, 'READ_HISTORY_BOOKMARKS': 367, 'READ_MMS': 368, 'READ_OWNER_DATA': 369, 'READ_PERMISSION': 370, 'READ_PHONE_STAT': 371, 'READ_PHONE_STATE': 372, 'READ_SECURE_SETTINGS': 373, 'READ_SETTINGS': 374, 'READ_SMS': 375, 'READ_WRITE': 376, 'RECEIVE': 377, 'RECEIVE_BOOT_CPMPLETED': 378, 'RECEIVE_MMS': 379, 'RECEIVE_SMS': 380, 'RECEIVE_WAP_PUSH': 381, 'RECORD_AUDIO': 382, 'RECORD_VIDEO': 383, 'SEND_SMS': 384, 'SET_ALARM': 385, 'UNINSTALL_SHORTCUT': 386, 'WIFI_LOCK': 387, 'WRITE_CALENDAR': 388, 'WRITE_CONTACTS': 389, 'WRITE_EXTERNAL_STORAGE': 390, 'WRITE_GMAIL': 391, 'WRITE_HISTORY_BOOKMARKS': 392, 'WRITE_OWNER_DATA': 393, 'WRITE_OWNER_FILE': 394, 'WRITE_PERMISSION': 395, 'WRITE_SECURE': 396, 'http://api.airpush.com': 397, 'http://app.wapx.cn': 398, 'http://client.go360days.com': 399, 'http://schemas.android.com': 400, 'http://10.0.0.172': 401, 'http://market.android.com': 402, 'http://r2.adwo.com': 403, 'https://market.android.com': 404, 'http://maps.google.com': 405, 'http://gad.ju6666.com': 406, 'http://ads.wapx.cn': 407, 'http://beta.vpon.com': 408, 'http://cn.ad.adon.vpon.com': 409, 'http://tw.ad.adon.vpon.com': 410, 'http://beta.airpush.com': 411, 'http://ads.waps.cn': 412, 'http://www.gstatic.com': 413, 'http://www.w3.org': 414, 'http://www.adwo.com': 415, 'http://adtest.adwo.com': 416, 'http://en.wikipedia.org': 417, 'http://www.searchmobileonline.com': 418, 'http://app.waps.cn': 419, 'http://fwd.3g.qq.com:8080': 420, 'http://a.admob.com': 421, 'http://ad.leadbolt.net': 422, 'http://ad.leadboltapps.net': 423, 'http://www.vpon.com': 424, 'http://axy.waplove.cn:8080': 425, 'http://cfg.adsmogo.com': 426, 'http://ade.wooboo.com.cn': 427, 'https://ws.tapjoyads.com': 428, 'http://googleads.g.doubleclick.net': 429, 'http://mm.admob.com': 430, 'http://www.youtube.com': 431, 'http://cus.adsmogo.com': 432, 'http://api.go108.cn': 433, 'http://www.umeng.com': 434, 'http://smsreplier.net': 435, 'http://clk.adsmogo.com': 436, 'http://imp.adsmogo.com': 437, 'http://mob.guohead.com': 438, 'http://req.adsmogo.com': 439, 'http://schemas.xmlsoap.org': 440, 'http://blk.adsmogo.com': 441, 'http://data.mobclix.com': 442, 'http://www.adsmogo.com': 443, 'https://play.google.com': 444, 'http://media.admob.com': 445, 'http://r.domob.cn': 446, 'http://www.umeng.co': 447, 'http://play.google.com': 448, 'http://su.5k3g.com': 449, 'http://maps.google': 450, 'http://twitter.com': 451, 'http://e.domob.cn': 452, 'http://androidsdk.ads.mp.mydas.mobi': 453, 'http://xmlpull.org': 454, 'http://sites.google.com': 455, 'http://d.wiyun.com': 456, 'http://211.99.197.56': 457, 'http://www.facebook.com': 458, 'http://www.google.com': 459, 'http://www.go108.com.cn': 460, 'http://androids-market.ru': 461, 'http://www.apperhand.com': 462, 'http://appnotify.forehandmedia.com': 463, 'http://ma.mkhoj.com': 464, 'https://graph.facebook.com': 465, 'http://client.139vps.com': 466, 'https://www.paypal.com': 467, 'http://wp.ysler.com': 468, 'http://c.admob.com': 469, 'http://www.googleadservices.com': 470, 'https://api.airpush.com': 471, 'http://10.0.0.172:80': 472, 'http://mobile.91.com': 473, 'http://ditu.google.com': 474, 'http://r.admob.com': 475, 'http://open.t.qq.com': 476, 'http://api.twitter.com': 477, 'http://battery-updates-android.net': 478, 'http://api.admob.com': 479, 'http://www.applovin.com': 480, 'https://bugsense.appspot.com': 481, 'http://ad.flurry.com': 482, 'http://d.applovin.com': 483, 'http://api.mixpanel.com': 484, 'http://mobile.tx.com.cn:8081': 485, 'http://search.gongfu-android.com:8511': 486, 'http://blackflyday.com': 487, 'http://gw.youmi.net': 488, 'http://domaindev.51widgets.com': 489, 'http://developer.android.com': 490, 'http://rest.tx.com.cn': 491, 'http://softfile.3g.qq.com:8080': 492, 'http://moba.rsigma.com': 493, 'http://www.androiddoctor.com': 494, 'https://chart.googleapis.com': 495, 'http://sigma.sgadtracker.com': 496, 'http://50.116.39.44': 497, 'http://ditu.google.cn': 498, 'http://www.tvchannelsfree.com': 499, 'http://xml.org': 500, 'http://client.mustmobile.com': 501, 'http://ads.senddroid.com': 502, 'http://push.senddroid.com': 503, 'https://m.facebook.com': 504, 'http://cvt.mydas.mobi': 505, 'http://wap.casee.cn': 506, 'http://www.appmedia.cn': 507, 'https://data.flurry.com': 508, 'http://data.flurry.com': 509, 'http://amob.acs86.com': 510, 'http://feedback.whalecloud.com': 511, 'http://my.mobfox.com': 512, 'http://rukodelniza.ru': 513, 'http://purl.org': 514, 'http://www.mojiva.com': 515, 'http://cfg.adsmogo.mobi': 516, 'http://cfg.adsmogo.net': 517, 'http://cfg.adsmogo.org': 518, 'http://millennialmedia.com': 519, 'http://twitter4j.org': 520, 'https://api.facebook.com': 521, 'http://ads.mp.mydas.mobi': 522, 'http://222.73.127.57:10670': 523, 'http://www.google.cn': 524, 'http://proxy.youdraw.cn': 525, 'http://yandex.ru': 526, 'http://jabber.org': 527, 'http://wap.soso.com': 528, 'http://mmsc.monternet.com': 529, 'http://code.google.com': 530, 'http://wps.appscolor.net': 531, 'http://ad.gongfu-android.com:7500': 532, 'http://kaixinai.com': 533, 'http://api.t.sina.com.cn': 534, 'http://cus.adsmogo.mobi': 535, 'http://cus.adsmogo.net': 536, 'http://cus.adsmogo.org': 537, 'http://m.tashequ.com': 538, 'http://www.adview.cn': 539, 'http://e.admob.com': 540, 'http://www.winads.cn': 541, 'http://lebar.gicp.net': 542, 'http://ns.adobe.com': 543, 'http://www.cs.caltech.edu': 544, 'http://www.weiguan.com': 545, 'https://www.facebook.com': 546, 'http://a.applovin.com': 547, 'http://activeqq.3g.qq.com': 548, 'http://schemas.applovin.com': 549, 'http://static.youmi.net': 550, 'https://api.scoreloop.com': 551, 'http://219.234.85.214': 552, 'http://ma.inmobi.com': 553, 'http://www.droidsettings.com': 554, 'http://www.wimolife.com': 555, 'http://developers.facebook.com': 556, 'http://mmsc.vnet.mobi': 557, 'http://soft.sj.91.com': 558, 'http://www.5j5l.com': 559, 'http://schemas.openxmlformats.org': 560, 'https://dev.twitter.com': 561, 'http://ads.mobclix.com': 562, 'http://www.mobclix.com': 563, 'http://log.ysler.com': 564, 'http://privacy-policy.truste.com': 565, 'http://vc.mobclix.com': 566, 'http://i.w.inmobi.com': 567, 'http://sdkstatic.heyzap.com': 568, 'http://wangwang8080.gicp.net': 569, 'http://assets.zestadz.com': 570, 'https://mobile.twitter.com': 571, 'http://61.145.124.93': 572, 'http://kawa.gnu.org': 573, 'http://status.twitter.com': 574, 'http://yusuke.homeip.net': 575, 'https://roa.myspace.com': 576, 'http://ads.lmmob.com': 577, 'http://91.213.175.176': 578, 'http://ad.jiemai-tech.com:7500': 579, 'http://appinvtinywebdb.appspot.com': 580, 'http://smsreplier.com': 581, 'http://cn.api.vpon.com': 582, 'http://hot.coolcode.org': 583, 'http://met.adwhirl.com': 584, 'http://162.105.131.113': 585, 'http://a.mobclix.com': 586, 'http://client.shu8.cn': 587, 'http://schemas.google.com': 588, 'http://blog.z.qq.com': 589, 'http://kiss.3g.qq.com': 590, 'http://www.baidu.com': 591, 'http://revmob.com': 592, 'http://www.apple.com': 593, 'http://adfonic.net': 594, 'http://wap.baidu.com': 595, 'http://d.91.com': 596, 'http://mjoy.91.com': 597, 'http://www.pixeltrack66.com': 598, 'http://pagead2.googlesyndication.com': 599, 'http://www.androidhat.org': 600, 'http://www.android-supermarket.com': 601}


# added = ['ACCESS', 'ACCESS_ASSISTED_GPS', 'ACCESS_CACHE_FILESYSTEM', 'ACCESS_CELL_ID', 'ACCESS_CHECKIN_PROPERTIES', 'ACCESS_COARSE_LOCATION', 'ACCESS_COARSE_UPDATES', 'ACCESS_DOWNLOAD_MANAGER', 'ACCESS_DOWNLOAD_MANAGER_ADVANCED', 'ACCESS_DRM', 'ACCESS_FINE_LOCATION', 'ACCESS_GPS', 'ACCESS_INTENTS', 'ACCESS_KUGOU_SERVICE', 'ACCESS_LOCATION', 'ACCESS_LOCATION_EXTRA_COMMANDS', 'ACCESS_LOCATTON_MOCK_LOCATION', 'ACCESS_MOCK_LOCATION', 'ACCESS_NETWORK_STATE', 'ACCESS_SURFACE_FLINGER', 'ACCESS_WIFI_STATE', 'ACCESS_WIMAX_STATE', 'ACCES_MOCK_LOCATION', 'ACCOUNT_MANAGER', 'ACTION_IMAGE_CAPTURE', 'ADD_SYSTEM_SERVICE', 'AUTHENTICATE_ACCOUNTS', 'BACKUP', 'BATTERY_STATS', 'BILLING', 'BIND_APPWIDGET', 'BIND_INPUT_METHOD', 'BIND_WALLPAPER', 'BLUETOOTH', 'BLUETOOTH_ADMIN', 'BOOT_COMPLETED', 'BRICK', 'BROADCAST_BADGE', 'BROADCAST_PACKAGE_ADDED', 'BROADCAST_PACKAGE_REMOVED', 'BROADCAST_SMS', 'BROADCAST_STICKY', 'BROADCAST_WAP_PUSH', 'C2D_MESSAGE', 'CALL_PHONE', 'CALL_PRIVILEGED', 'CAMERA', 'CENTRAL_SERVICE_PERMISSION', 'CHANGE_BADGE', 'CHANGE_COMPONENT_ENABLED_STATE', 'CHANGE_CONFIGURATION', 'CHANGE_NETWORK_STATE', 'CHANGE_WIFI_MULTICAST_STATE', 'CHANGE_WIFI_STATE', 'CHANGE_WIMAX_STATE', 'CHECK_LICENSE', 'CLEAR_APP_CACHE', 'CLEAR_APP_USER_DATA', 'CONTROL_LOCATION_UPDATES', 'DELETE_CACHE_FILES', 'DELETE_PACKAGES', 'DEVICE_POWER', 'DIAGNOSTIC', 'DISABLE_KEYGUARD', 'DOWNLOAD_WITHOUT_NOTIFICATION', 'DUMP', 'EXPAND_STATUS_BAR', 'FACTORY_TEST', 'FLASHLIGHT', 'FORCE_BACK', 'FORCE_STOP_PACKAGES', 'FULLSCREEN', 'FULL_SCREEN', 'GET_ACCOUNTS', 'GET_PACKAGE_SIZE', 'GET_TASKS', 'GLOBAL_SEARCH', 'GLOBAL_SEARCH_CONTROL', 'GOOGLE_AUTH', 'HARDWARE_TEST', 'INJECT_EVENTS', 'INSTALL_DRM', 'INSTALL_LOCATION_PROVIDER', 'INSTALL_PACKAGES', 'INSTALL_SHORTCUT', 'INTERNAL_SYSTEM_WINDOW', 'INTERNET', 'KILL_BACKGROUND_PROCESSES', 'LISTEN_CALL_STATE', 'LOCATION', 'MANAGE_ACCOUNTS', 'MANAGE_APP_TOKENS', 'MASTER_CLEAR', 'MODIFY_AUDIO_SETTINGS', 'MODIFY_PHONE_STATE', 'MOUNT_FORMAT_FILESYSTEMS', 'MOUNT_UNMOUNT_FILESYSTEMS', 'NEW_OUTGOING_CALL', 'NFC', 'PERMISSION', 'PERMISSION_NAME', 'PERSISTENT_ACTIVITY', 'PLUGIN', 'PROCESS_CALL', 'PROCESS_INCOMING_CALLS', 'PROCESS_OUTGOING_CALLS', 'PROVIDER_INSERT_BADGE', 'RAISED_THREAD_PRIORITY', 'READ', 'READ_CALENDAR', 'READ_CONTACTS', 'READ_EXTERNAL_STORAGE', 'READ_FRAME_BUFFER', 'READ_GMAIL', 'READ_GSERVICES', 'READ_HISTORY_BOOKMARKS', 'READ_INPUT_STATE', 'READ_LOGS', 'READ_MMS', 'READ_OWNER_DATA', 'READ_PERMISSION', 'READ_PHONE_STAT', 'READ_PHONE_STATE', 'READ_SECURE_SETTINGS', 'READ_SETTINGS', 'READ_SMS', 'READ_SYNC_SETTINGS', 'READ_SYNC_STATS', 'READ_USER_DICTIONARY', 'READ_WRITE', 'REBOOT', 'RECEIVE', 'RECEIVE_BOOT_COMPLETED', 'RECEIVE_BOOT_CPMPLETED', 'RECEIVE_MMS', 'RECEIVE_SMS', 'RECEIVE_WAP_PUSH', 'RECORD_AUDIO', 'RECORD_VIDEO', 'REORDER_TASKS', 'RESTART_PACKAGES', 'SEND_DOWNLOAD_COMPLETED_INTENTS', 'SEND_SMS', 'SET_ACTIVITY_WATCHER', 'SET_ALARM', 'SET_ALWAYS_FINISH', 'SET_ANIMATION_SCALE', 'SET_DEBUG_APP', 'SET_ORIENTATION', 'SET_PREFERRED_APPLICATIONS', 'SET_PROCESS_LIMIT', 'SET_TIME_ZONE', 'SET_WALLPAPER', 'SET_WALLPAPER_COMPONENT', 'SET_WALLPAPER_HINTS', 'SIGNAL_PERSISTENT_PROCESSES', 'STATUS_BAR', 'SUBSCRIBED_FEEDS_READ', 'SUBSCRIBED_FEEDS_WRITE', 'SYSTEM_ALERT_WINDOW', 'UNINSTALL_SHORTCUT', 'UPDATE_BADGE', 'UPDATE_COUNT', 'UPDATE_DEVICE_STATS', 'UPDATE_SHORTCUT', 'USE_CREDENTIALS', 'VIBRATE', 'WAKE_LOCK', 'WIFI_LOCK', 'WRITE', 'WRITE_APN_SETTINGS', 'WRITE_CALENDAR', 'WRITE_CONTACTS', 'WRITE_EXTERNAL_STORAGE', 'WRITE_GMAIL', 'WRITE_GSERVICES', 'WRITE_HISTORY_BOOKMARKS', 'WRITE_MEDIA_STORAGE', 'WRITE_OWNER_DATA', 'WRITE_OWNER_FILE', 'WRITE_PERMISSION', 'WRITE_SECURE', 'WRITE_SECURE_SETTINGS', 'WRITE_SETTINGS', 'WRITE_SMS', 'WRITE_SYNC_SETTINGS']
# test_features = {'ACCESS_ALL_DOWNLOADS': 0, 'ACCESS_BLUETOOTH_SHARE': 1, 'ACCESS_CACHE_FILESYSTEM': 2, 'ACCESS_CHECKIN_PROPERTIES': 3, 'ACCESS_CONTENT_PROVIDERS_EXTERNALLY': 4, 'ACCESS_DOWNLOAD_MANAGER': 5, 'ACCESS_DOWNLOAD_MANAGER_ADVANCED': 6, 'ACCESS_DRM_CERTIFICATES': 7, 'ACCESS_EPHEMERAL_APPS': 8, 'ACCESS_FM_RADIO': 9, 'ACCESS_INPUT_FLINGER': 10, 'ACCESS_KEYGUARD_SECURE_STORAGE': 11, 'ACCESS_LOCATION_EXTRA_COMMANDS': 12, 'ACCESS_MOCK_LOCATION': 13, 'ACCESS_MTP': 14, 'ACCESS_NETWORK_CONDITIONS': 15, 'ACCESS_NETWORK_STATE': 16, 'ACCESS_NOTIFICATIONS': 17, 'ACCESS_NOTIFICATION_POLICY': 18, 'ACCESS_PDB_STATE': 19, 'ACCESS_SURFACE_FLINGER': 20, 'ACCESS_VOICE_INTERACTION_SERVICE': 21, 'ACCESS_VR_MANAGER': 22, 'ACCESS_WIFI_STATE': 23, 'ACCESS_WIMAX_STATE': 24, 'ACCOUNT_MANAGER': 25, 'ALLOW_ANY_CODEC_FOR_PLAYBACK': 26, 'ASEC_ACCESS': 27, 'ASEC_CREATE': 28, 'ASEC_DESTROY': 29, 'ASEC_MOUNT_UNMOUNT': 30, 'ASEC_RENAME': 31, 'AUTHENTICATE_ACCOUNTS': 32, 'BACKUP': 33, 'BATTERY_STATS': 34, 'BIND_ACCESSIBILITY_SERVICE': 35, 'BIND_APPWIDGET': 36, 'BIND_CARRIER_MESSAGING_SERVICE': 37, 'BIND_CARRIER_SERVICES': 38, 'BIND_CHOOSER_TARGET_SERVICE': 39, 'BIND_CONDITION_PROVIDER_SERVICE': 40, 'BIND_CONNECTION_SERVICE': 41, 'BIND_DEVICE_ADMIN': 42, 'BIND_DIRECTORY_SEARCH': 43, 'BIND_DREAM_SERVICE': 44, 'BIND_INCALL_SERVICE': 45, 'BIND_INPUT_METHOD': 46, 'BIND_INTENT_FILTER_VERIFIER': 47, 'BIND_JOB_SERVICE': 48, 'BIND_KEYGUARD_APPWIDGET': 49, 'BIND_MIDI_DEVICE_SERVICE': 50, 'BIND_NFC_SERVICE': 51, 'BIND_NOTIFICATION_LISTENER_SERVICE': 52, 'BIND_NOTIFICATION_RANKER_SERVICE': 53, 'BIND_PACKAGE_VERIFIER': 54, 'BIND_PRINT_RECOMMENDATION_SERVICE': 55, 'BIND_PRINT_SERVICE': 56, 'BIND_PRINT_SPOOLER_SERVICE': 57, 'BIND_QUICK_SETTINGS_TILE': 58, 'BIND_REMOTEVIEWS': 59, 'BIND_REMOTE_DISPLAY': 60, 'BIND_ROUTE_PROVIDER': 61, 'BIND_RUNTIME_PERMISSION_PRESENTER_SERVICE': 62, 'BIND_SCREENING_SERVICE': 63, 'BIND_TELECOM_CONNECTION_SERVICE': 64, 'BIND_TEXT_SERVICE': 65, 'BIND_TRUST_AGENT': 66, 'BIND_TV_INPUT': 67, 'BIND_TV_REMOTE_SERVICE': 68, 'BIND_VOICE_INTERACTION': 69, 'BIND_VPN_SERVICE': 70, 'BIND_VR_LISTENER_SERVICE': 71, 'BIND_WALLPAPER': 72, 'BLUETOOTH': 73, 'BLUETOOTH_ADMIN': 74, 'BLUETOOTH_MAP': 75, 'BLUETOOTH_PRIVILEGED': 76, 'BLUETOOTH_STACK': 77, 'BRICK': 78, 'BROADCAST_CALLLOG_INFO': 79, 'BROADCAST_NETWORK_PRIVILEGED': 80, 'BROADCAST_PACKAGE_REMOVED': 81, 'BROADCAST_PHONE_ACCOUNT_REGISTRATION': 82, 'BROADCAST_SMS': 83, 'BROADCAST_STICKY': 84, 'BROADCAST_WAP_PUSH': 85, 'CACHE_CONTENT': 86, 'CALL_PRIVILEGED': 87, 'CAMERA_DISABLE_TRANSMIT_LED': 88, 'CAMERA_SEND_SYSTEM_EVENTS': 89, 'CAPTURE_AUDIO_HOTWORD': 90, 'CAPTURE_AUDIO_OUTPUT': 91, 'CAPTURE_SECURE_VIDEO_OUTPUT': 92, 'CAPTURE_TV_INPUT': 93, 'CAPTURE_VIDEO_OUTPUT': 94, 'CARRIER_FILTER_SMS': 95, 'CHANGE_APP_IDLE_STATE': 96, 'CHANGE_BACKGROUND_DATA_SETTING': 97, 'CHANGE_COMPONENT_ENABLED_STATE': 98, 'CHANGE_CONFIGURATION': 99, 'CHANGE_DEVICE_IDLE_TEMP_WHITELIST': 100, 'CHANGE_NETWORK_STATE': 101, 'CHANGE_WIFI_MULTICAST_STATE': 102, 'CHANGE_WIFI_STATE': 103, 'CHANGE_WIMAX_STATE': 104, 'CLEAR_APP_CACHE': 105, 'CLEAR_APP_GRANTED_URI_PERMISSIONS': 106, 'CLEAR_APP_USER_DATA': 107, 'CONFIGURE_DISPLAY_COLOR_TRANSFORM': 108, 'CONFIGURE_WIFI_DISPLAY': 109, 'CONFIRM_FULL_BACKUP': 110, 'CONNECTIVITY_INTERNAL': 111, 'CONTROL_INCALL_EXPERIENCE': 112, 'CONTROL_KEYGUARD': 113, 'CONTROL_LOCATION_UPDATES': 114, 'CONTROL_VPN': 115, 'CONTROL_WIFI_DISPLAY': 116, 'COPY_PROTECTED_DATA': 117, 'CREATE_USERS': 118, 'CRYPT_KEEPER': 119, 'DELETE_CACHE_FILES': 120, 'DELETE_PACKAGES': 121, 'DEVICE_POWER': 122, 'DIAGNOSTIC': 123, 'DISABLE_KEYGUARD': 124, 'DISPATCH_NFC_MESSAGE': 125, 'DISPATCH_PROVISIONING_MESSAGE': 126, 'DOWNLOAD_CACHE_NON_PURGEABLE': 127, 'DUMP': 128, 'DVB_DEVICE': 129, 'EXPAND_STATUS_BAR': 130, 'FACTORY_TEST': 131, 'FILTER_EVENTS': 132, 'FLASHLIGHT': 133, 'FORCE_BACK': 134, 'FORCE_STOP_PACKAGES': 135, 'FRAME_STATS': 136, 'FREEZE_SCREEN': 137, 'GET_ACCOUNTS_PRIVILEGED': 138, 'GET_APP_GRANTED_URI_PERMISSIONS': 139, 'GET_APP_OPS_STATS': 140, 'GET_DETAILED_TASKS': 141, 'GET_INTENT_SENDER_INTENT': 142, 'GET_PACKAGE_IMPORTANCE': 143, 'GET_PACKAGE_SIZE': 144, 'GET_PASSWORD': 145, 'GET_PROCESS_STATE_AND_OOM_SCORE': 146, 'GET_TASKS': 147, 'GET_TOP_ACTIVITY_INFO': 148, 'GLOBAL_SEARCH': 149, 'GLOBAL_SEARCH_CONTROL': 150, 'GRANT_RUNTIME_PERMISSIONS': 151, 'HARDWARE_TEST': 152, 'HDMI_CEC': 153, 'INJECT_EVENTS': 154, 'INSTALL_GRANT_RUNTIME_PERMISSIONS': 155, 'INSTALL_LOCATION_PROVIDER': 156, 'INSTALL_PACKAGES': 157, 'INTENT_FILTER_VERIFICATION_AGENT': 158, 'INTERACT_ACROSS_USERS': 159, 'INTERACT_ACROSS_USERS_FULL': 160, 'INTERNAL_SYSTEM_WINDOW': 161, 'INTERNET': 162, 'INVOKE_CARRIER_SETUP': 163, 'KILL_BACKGROUND_PROCESSES': 164, 'KILL_UID': 165, 'LAUNCH_TRUST_AGENT_SETTINGS': 166, 'LOCAL_MAC_ADDRESS': 167, 'LOCATION_HARDWARE': 168, 'LOOP_RADIO': 169, 'MANAGE_ACCOUNTS': 170, 'MANAGE_ACTIVITY_STACKS': 171, 'MANAGE_APP_OPS_RESTRICTIONS': 172, 'MANAGE_APP_TOKENS': 173, 'MANAGE_CA_CERTIFICATES': 174, 'MANAGE_DEVICE_ADMINS': 175, 'MANAGE_DOCUMENTS': 176, 'MANAGE_FINGERPRINT': 177, 'MANAGE_MEDIA_PROJECTION': 178, 'MANAGE_NETWORK_POLICY': 179, 'MANAGE_NOTIFICATIONS': 180, 'MANAGE_PROFILE_AND_DEVICE_OWNERS': 181, 'MANAGE_SOUND_TRIGGER': 182, 'MANAGE_USB': 183, 'MANAGE_USERS': 184, 'MANAGE_VOICE_KEYPHRASES': 185, 'MASTER_CLEAR': 186, 'MEDIA_CONTENT_CONTROL': 187, 'MODIFY_APPWIDGET_BIND_PERMISSIONS': 188, 'MODIFY_AUDIO_ROUTING': 189, 'MODIFY_AUDIO_SETTINGS': 190, 'MODIFY_CELL_BROADCASTS': 191, 'MODIFY_DAY_NIGHT_MODE': 192, 'MODIFY_NETWORK_ACCOUNTING': 193, 'MODIFY_PARENTAL_CONTROLS': 194, 'MODIFY_PHONE_STATE': 195, 'MOUNT_FORMAT_FILESYSTEMS': 196, 'MOUNT_UNMOUNT_FILESYSTEMS': 197, 'MOVE_PACKAGE': 198, 'NET_ADMIN': 199, 'NET_TUNNELING': 200, 'NFC': 201, 'NFC_HANDOVER_STATUS': 202, 'NOTIFY_PENDING_SYSTEM_UPDATE': 203, 'OBSERVE_GRANT_REVOKE_PERMISSIONS': 204, 'OEM_UNLOCK_STATE': 205, 'OVERRIDE_WIFI_CONFIG': 206, 'PACKAGE_USAGE_STATS': 207, 'PACKAGE_VERIFICATION_AGENT': 208, 'PACKET_KEEPALIVE_OFFLOAD': 209, 'PEERS_MAC_ADDRESS': 210, 'PERFORM_CDMA_PROVISIONING': 211, 'PERFORM_SIM_ACTIVATION': 212, 'PERSISTENT_ACTIVITY': 213, 'PROCESS_CALLLOG_INFO': 214, 'PROCESS_PHONE_ACCOUNT_REGISTRATION': 215, 'PROVIDE_TRUST_AGENT': 216, 'QUERY_DO_NOT_ASK_CREDENTIALS_ON_BOOT': 217, 'READ_BLOCKED_NUMBERS': 218, 'READ_DREAM_STATE': 219, 'READ_FRAME_BUFFER': 220, 'READ_INPUT_STATE': 221, 'READ_INSTALL_SESSIONS': 222, 'READ_LOGS': 223, 'READ_NETWORK_USAGE_HISTORY': 224, 'READ_OEM_UNLOCK_STATE': 225, 'READ_PRECISE_PHONE_STATE': 226, 'READ_PRIVILEGED_PHONE_STATE': 227, 'READ_PROFILE': 228, 'READ_SEARCH_INDEXABLES': 229, 'READ_SOCIAL_STREAM': 230, 'READ_SYNC_SETTINGS': 231, 'READ_SYNC_STATS': 232, 'READ_USER_DICTIONARY': 233, 'READ_WIFI_CREDENTIAL': 234, 'REAL_GET_TASKS': 235, 'REBOOT': 236, 'RECEIVE_BLUETOOTH_MAP': 237, 'RECEIVE_BOOT_COMPLETED': 238, 'RECEIVE_DATA_ACTIVITY_CHANGE': 239, 'RECEIVE_EMERGENCY_BROADCAST': 240, 'RECEIVE_MEDIA_RESOURCE_USAGE': 241, 'RECEIVE_STK_COMMANDS': 242, 'RECEIVE_WIFI_CREDENTIAL_CHANGE': 243, 'RECOVERY': 244, 'REGISTER_CALL_PROVIDER': 245, 'REGISTER_CONNECTION_MANAGER': 246, 'REGISTER_SIM_SUBSCRIPTION': 247, 'REGISTER_WINDOW_MANAGER_LISTENERS': 248, 'REMOTE_AUDIO_PLAYBACK': 249, 'REMOVE_DRM_CERTIFICATES': 250, 'REMOVE_TASKS': 251, 'REORDER_TASKS': 252, 'REQUEST_IGNORE_BATTERY_OPTIMIZATIONS': 253, 'REQUEST_INSTALL_PACKAGES': 254, 'RESET_FINGERPRINT_LOCKOUT': 255, 'RESET_SHORTCUT_MANAGER_THROTTLING': 256, 'RESTART_PACKAGES': 257, 'RETRIEVE_WINDOW_CONTENT': 258, 'RETRIEVE_WINDOW_TOKEN': 259, 'REVOKE_RUNTIME_PERMISSIONS': 260, 'SCORE_NETWORKS': 261, 'SEND_CALL_LOG_CHANGE': 262, 'SEND_DOWNLOAD_COMPLETED_INTENTS': 263, 'SEND_RESPOND_VIA_MESSAGE': 264, 'SEND_SMS_NO_CONFIRMATION': 265, 'SERIAL_PORT': 266, 'SET_ACTIVITY_WATCHER': 267, 'SET_ALWAYS_FINISH': 268, 'SET_ANIMATION_SCALE': 269, 'SET_DEBUG_APP': 270, 'SET_INPUT_CALIBRATION': 271, 'SET_KEYBOARD_LAYOUT': 272, 'SET_ORIENTATION': 273, 'SET_POINTER_SPEED': 274, 'SET_PREFERRED_APPLICATIONS': 275, 'SET_PROCESS_LIMIT': 276, 'SET_SCREEN_COMPATIBILITY': 277, 'SET_TIME': 278, 'SET_TIME_ZONE': 279, 'SET_WALLPAPER': 280, 'SET_WALLPAPER_COMPONENT': 281, 'SET_WALLPAPER_HINTS': 282, 'SHUTDOWN': 283, 'SIGNAL_PERSISTENT_PROCESSES': 284, 'START_ANY_ACTIVITY': 285, 'START_PRINT_SERVICE_CONFIG_ACTIVITY': 286, 'START_TASKS_FROM_RECENTS': 287, 'STATUS_BAR': 288, 'STATUS_BAR_SERVICE': 289, 'STOP_APP_SWITCHES': 290, 'STORAGE_INTERNAL': 291, 'SUBSCRIBED_FEEDS_READ': 292, 'SUBSCRIBED_FEEDS_WRITE': 293, 'SUBSTITUTE_NOTIFICATION_APP_NAME': 294, 'SYSTEM_ALERT_WINDOW': 295, 'TABLET_MODE': 296, 'TEMPORARY_ENABLE_ACCESSIBILITY': 297, 'TETHER_PRIVILEGED': 298, 'TRANSMIT_IR': 299, 'TRUST_LISTENER': 300, 'TV_INPUT_HARDWARE': 301, 'TV_VIRTUAL_REMOTE_CONTROLLER': 302, 'UPDATE_APP_OPS_STATS': 303, 'UPDATE_CONFIG': 304, 'UPDATE_DEVICE_STATS': 305, 'UPDATE_LOCK': 306, 'UPDATE_LOCK_TASK_PACKAGES': 307, 'USER_ACTIVITY': 308, 'USE_CREDENTIALS': 309, 'VIBRATE': 310, 'WAKE_LOCK': 311, 'WRITE_APN_SETTINGS': 312, 'WRITE_BLOCKED_NUMBERS': 313, 'WRITE_DREAM_STATE': 314, 'WRITE_GSERVICES': 315, 'WRITE_MEDIA_STORAGE': 316, 'WRITE_PROFILE': 317, 'WRITE_SECURE_SETTINGS': 318, 'WRITE_SETTINGS': 319, 'WRITE_SMS': 320, 'WRITE_SOCIAL_STREAM': 321, 'WRITE_SYNC_SETTINGS': 322, 'WRITE_USER_DICTIONARY': 323, 'ACCESS': 323, 'ACCESS_ASSISTED_GPS': 324, 'ACCESS_CELL_ID': 325, 'ACCESS_COARSE_LOCATION': 326, 'ACCESS_COARSE_UPDATES': 327, 'ACCESS_DRM': 328, 'ACCESS_FINE_LOCATION': 329, 'ACCESS_GPS': 330, 'ACCESS_INTENTS': 331, 'ACCESS_KUGOU_SERVICE': 332, 'ACCESS_LOCATION': 333, 'ACCESS_LOCATTON_MOCK_LOCATION': 334, 'ACCES_MOCK_LOCATION': 335, 'ACTION_IMAGE_CAPTURE': 336, 'ADD_SYSTEM_SERVICE': 337, 'BILLING': 338, 'BOOT_COMPLETED': 339, 'BROADCAST_PACKAGE_ADDED': 340, 'C2D_MESSAGE': 341, 'CALL_PHONE': 342, 'CAMERA': 343, 'CENTRAL_SERVICE_PERMISSION': 344, 'CHECK_LICENSE': 345, 'FULLSCREEN': 346, 'FULL_SCREEN': 347, 'GET_ACCOUNTS': 348, 'GOOGLE_AUTH': 349, 'INSTALL_DRM': 350, 'INSTALL_SHORTCUT': 351, 'LISTEN_CALL_STATE': 352, 'LOCATION': 353, 'NEW_OUTGOING_CALL': 354, 'PERMISSION': 355, 'PERMISSION_NAME': 356, 'PLUGIN': 357, 'PROCESS_CALL': 358, 'PROCESS_INCOMING_CALLS': 359, 'PROCESS_OUTGOING_CALLS': 360, 'RAISED_THREAD_PRIORITY': 361, 'READ_CALENDAR': 362, 'READ_CONTACTS': 363, 'READ_EXTERNAL_STORAGE': 364, 'READ_GMAIL': 365, 'READ_GSERVICES': 366, 'READ_HISTORY_BOOKMARKS': 367, 'READ_MMS': 368, 'READ_OWNER_DATA': 369, 'READ_PERMISSION': 370, 'READ_PHONE_STAT': 371, 'READ_PHONE_STATE': 372, 'READ_SECURE_SETTINGS': 373, 'READ_SETTINGS': 374, 'READ_SMS': 375, 'READ_WRITE': 376, 'RECEIVE': 377, 'RECEIVE_BOOT_CPMPLETED': 378, 'RECEIVE_MMS': 379, 'RECEIVE_SMS': 380, 'RECEIVE_WAP_PUSH': 381, 'RECORD_AUDIO': 382, 'RECORD_VIDEO': 383, 'SEND_SMS': 384, 'SET_ALARM': 385, 'UNINSTALL_SHORTCUT': 386, 'WIFI_LOCK': 387, 'WRITE_CALENDAR': 388, 'WRITE_CONTACTS': 389, 'WRITE_EXTERNAL_STORAGE': 390, 'WRITE_GMAIL': 391, 'WRITE_HISTORY_BOOKMARKS': 392, 'WRITE_OWNER_DATA': 393, 'WRITE_OWNER_FILE': 394, 'WRITE_PERMISSION': 395, 'WRITE_SECURE': 396, 'BROADCAST_BADGE': 397, 'CHANGE_BADGE': 398, 'DOWNLOAD_WITHOUT_NOTIFICATION': 399, 'PROVIDER_INSERT_BADGE': 400, 'READ': 401, 'UPDATE_BADGE': 402, 'UPDATE_COUNT': 403, 'UPDATE_SHORTCUT': 404, 'WRITE': 405}

global file_size, UNI_VALUE, MAX_SERVICE


def make_feature(list_data):
	perm_dict = dict()
	for i in range(len(list_data)):
		perm_dict[list_data[i]] = i

	return perm_dict

def make_service_as_feature(services):
	global MAX_SERVICE
	if (services) > MAX_SERVICE:
		MAX_SERVICE = (services)

	return (services)/MAX_SERVICE

def convert2decimal(str):
	values = 0
	for c in str:
		values += ord(c)

	return values

# [permissions], file_size, is_use_nativelibc, is_declare_new_permission, percentofservice
def calculate_decimal_form(list_of_features, name, label, apk):
	dataset = list()
	#Make default
	dataset.append(map_num[label])
	for idx in range(len(permision_feature)):
		dataset.append(0)

	for feature in (list_of_features):
		if 'http' in feature or 'https' in feature:
			feat = feature	
		else:
			feat = feature.split(".")[-1]
		try:
			dataset[permision_feature[feat]] = 1
		except Exception as ex:
			print("[Error] - {}\nCan not file this feature".format(feat))
			with open("api_fail", "a+", encoding='utf8') as f:
				f.write(feat)
				f.write('\n')

	# print(list_of_features)
	# print(dataset)
	# add file size as a feature
	global file_size
	dataset.append(file_size/ (1024*1024*1024) )

	# add is_use_nativelib as a feature
	is_use_nativelib = len(apk.get_libraries())

	if is_use_nativelib == 0:
		dataset.append(0)
	else:
		dataset.append(is_use_nativelib/is_use_nativelib)

	#add is Declare new permission as a feature
	is_declare_new_feature = len(apk.get_declared_permissions())
	if is_declare_new_feature == 0:
		dataset.append(0)
	else:
		dataset.append(is_declare_new_feature/is_declare_new_feature)

	# # add percent of service as a rate
	list_of_services = len(apk.get_services())
	if list_of_services == 0:
		dataset.append(0)
	else:
		rate_of_service = make_service_as_feature(list_of_services)
		dataset.append(rate_of_service)

	# # count appear feature per samples
	total_feature = len(dataset) -1 
	count_feature = 0
	for e in dataset:
		if e != 0:
			count_feature += 1

	dataset.append(count_feature/total_feature)

	str_dataset = [str(e) for e in dataset]
	if (is_use_nativelib or is_declare_new_feature or list_of_services):
		with open("noted_special_features", "a+") as f:
			f.write("Nativelib: {}\nDeclare new feature: {}\nServices: {}\n\tPath: {}\n\n".format(is_use_nativelib, is_declare_new_feature, list_of_services, name))
	# print(dataset)

	with open("./info.txt", "a+") as f:
		f.write("\n===== {} =======".format(label))
		f.write("\n\tNumber of column: {}".format(len(dataset)))
		f.write("\n\tNumber of permission: {}".format(len(permision_feature)))
		f.write("\n\tNumber of services: {}".format(list_of_services))
		f.write("\n\tNumber of declared permission: {}".format(is_declare_new_feature))
		f.write("\n\tUse native libc: {}".format(is_use_nativelib))
		f.write("\n\tTotal features of sample: {}".format(total_feature))
		f.write("===============================\n")

	return dataset

def read_apk(path):
	apk = APK(path)

	return apk

def extract_feature(apk):
	perm = apk.get_permissions()
	path = apk.filename.split("\\")

	filename = path[-1]
	label = path[-2]
	filename = filename.split(".apk")[0]
	return perm, filename, label

def create_workbook(book_name, data):
	if ".csv" not in book_name:
		book_name = book_name.split(".")[0] + ".csv"
	
	# workbook = xlsxwriter.Workbook(book_name)
	# worksheet = workbook.add_worksheet()


	# for row in range(len(data)):
	# 	for col in range(len(data[row])):
	# 		worksheet.write(row, col, data[row][col])
	# 	print("\t\t\t\t --- Wrote ---")
	# 	print(data[row])


	# workbook.close()

	with open(book_name, 'a+', newline='\n') as csvfile:
		csvwriter = csv.writer(csvfile, delimiter=',',
	                            quotechar='|', quoting=csv.QUOTE_MINIMAL)
		for row in data:
			csvwriter.writerow(row)
	# with open(book_name, "a+") as f:
	# 	for row in data:
	# 		f.write(', '.join(row))
	# 		f.write('\n')
	return book_name

def get_perm(apk):
	p = list()
	for el in apk.get_permissions():
		x = el.split(".")[-1]
		p.append(x)
	return p


def make_dirs_family():
	with open("sha256_family.csv", "r") as f:
		raw_data = f.read().split("\n")

	family = list()
	maping = list()
	maps = dict()
	for row in raw_data:
		da = row.split(",")
##		while('' in da):
##			da.remove('')
		while([''] in da):
			da.remove([])

		#print(da)
		maping.append(da)
		family.append(da[1])

	family = set(sorted(family))
	#print(len(family))
	basedir = ".\\Samples"


	# root, dirs, files = os.walk(basedir)
	count = 0
	for folder in family:
		try:
			os.makedirs(os.path.join(basedir, folder))
			count += 1
		except:
			pass

	print("[+] Made {} dirs successfull!".format(count))
	
	for e in maping:
		maps[e[0]] = e[1]

	return maps

def map_hash_with_its_family(name, full_path, maps, bashdir):
	family = maps[name.split(".")[0]]
	new_path = os.path.join(bashdir, family)
	#print(full_path, new_path)
	try:
		shutil.copy2(full_path, new_path)
	except:
		pass

	return


def move_samples_2_family(path):
	maps = make_dirs_family()
	for root, dirs, files in os.walk(path):
		for file in files:
			f_path = os.path.join(root, file)
			# print(root)
			try:
				map_hash_with_its_family(file, f_path, maps, r".\\Samples")
			except:
				pass

	return


def change_name(path):
	count = 0
	for root, dirs, filenames in os.walk(path):
		for file in filenames:
			if(".apk" not in file):
				try:
					os.rename(os.path.join(root,file), os.path.join(root,(file+".apk")))
					count += 1
				except Exception as ex:
					with open("log.txt", "a+", encoding='utf8') as f:
						f.write("[CHANGE_NAME] - {}".format(ex))
					pass 
				


def map_number(path):
    data = dict()
    idx = 0
    for root, dirs, files in os.walk(path):
        x = root.split("\\")[-1]
        if (x != "Data"):
	        data[x] = idx
	        idx += 1
    return data
    
def join_feature(a, b):
	last_values = len(a) -1
	for e in b:
		if e not in a:
			a[e] = last_values
			last_values += 1

	return a


def get_rank_api(_api, api):
	if(_api in api):
		api[_api] = api[_api] + 1
	else:
		api[_api] = len(api)-1 

	return

def extract_api(string):
	return re.findall(b'(https?://[^ \t\n\r\f\v\0\//]+)', string)


def main(exception='None'):
	datasets = list()
	for root, dirs, files in os.walk(path):
		#print(root, dirs, files)
		for file in files:
			full_path = os.path.join(root, file)
			print(full_path)
			if ".apk" in file and exception not in root:
				try:
					target = read_apk(full_path)
					global file_size
					file_size = os.path.getsize(full_path)
					perm, name, label = extract_feature(target)
					# for d in target.get_all_dex():
					# 	api_ = extract_api(d)

					# fapi = list()
					# for e in api_:
					# 	fapi.append(e.decode())

					datasets.append( calculate_decimal_form((perm), name, label, target) )

					print("[LOG] - Extracted successfull - {}".format(file))
				except Exception as ex:
					data = "[{}] - {}".format(file, ex)
					print(data)
					with open("log.txt", "a+", encoding='utf8') as f:
						f.writelines(data)
					pass

	create_workbook(output_name, datasets)
	return


def main_extract_perm(path, output_name):
	datasets = list()
	with open("./info.txt", "a+") as f:
		f.write("============= INFO ===============")
    
	count = 0
	for root, dirs, files in os.walk(path):
		#print(root, dirs, files)
		for file in files:
			print(os.path.join(root, file))
			if ".apk" in file:
				try:
					target = read_apk(os.path.join(root, file))
					global file_size
					file_size = os.path.getsize(os.path.join(root, file))

					data = get_perm(target)
					for el in data:
						datasets.append(el)
						if(el not in full_features):
							with open("new_features.data", "a+") as f:
								f.write(el)
								f.write("\n")
					count += 1
				except Exception as ex:
					data = "[{}] - {}".format(file, ex)
					with open("log.txt", "a+") as f:
						f.write(data)
						f.write("\n")
					pass


				# perm, name, label = extract_feature(target)
				# datasets.append( calculate_decimal_form(perm, name, label) )


			print("[LOG] - Extracted successfull - {}".format(file))

	print("Extracting success with {} samples".format(count))
	return 

def main_extract_api(path):
	datasets = list()
	with open("./info.txt", "a+") as f:
		f.write("============= INFO ===============")
    
	count = 0
	for root, dirs, files in os.walk(path):
		#print(root, dirs, files)
		ap = api
		for file in files:
			print(os.path.join(root, file))
			if ".apk" in file:
				try:
					target = read_apk(os.path.join(root, file))
					for raw in target.get_all_dex():
						data = extract_api(raw)

					for el in data:
						# datasets.append(el)
						a = el
						get_rank_api(a, ap)


					count += 1
				except Exception as ex:
					data = "[{}] - {}".format(file, ex)
					with open("log.txt", "a+", encoding='utf-8') as f:
						f.write(data)
						f.write("\n")
					pass


				# perm, name, label = extract_feature(target)
				# datasets.append( calculate_decimal_form(perm, name, label) )


			print("[LOG] - Extracted successfull - {}".format(file))
		print(ap)
	# print(sorted(set(datasets)))

	with open("./API.txt", "a+", encoding='utf-8') as f:
		for el in datasets:
			f.write(el.decode())

	print("Extracting success with {} samples".format(count))
	return 


if __name__ == '__main__':
	path = r"E:\AnhNLQ\Data"
	# path = r"C:\Users\cloud\Downloads\Quarantines\Malware Samples\feature_vectors"
	output_name = "full_features_v1"
	permision_feature = full_features #join_feature(full_features, api)

	global file_size, UNI_VALUE, MAX_SERVICE
	#Define default values
	UNI_VALUE = ord("Z")
	MAX_SERVICE = 100


	#move_samples_2_family(path)
	# print(join_feature(full_features, drebin_features))
	# change_name(path)
	main()
	# main_extract_perm(path, output_name)
	# print(make_feature(temp))
	# main_extract_api(path)
